

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="Curso de análisis de datos de secuenciación masiva para la identificación de variantes genómicas" lang="es" name="description" xml:lang="es" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Call me by your reads &mdash; documentación de Call me by your reads - 0.0.1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> Call me by your reads
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Call me by your reads</a><ul>
<li><a class="reference internal" href="#crash-course-de-llamado-de-variantes-genomicas">Crash course de llamado de variantes genómicas</a></li>
<li><a class="reference internal" href="#introduccion">Introducción</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linux"><span class="xref std std-doc">Linux</span></a><ul>
<li><a class="reference internal" href="#id1">Introducción</a></li>
<li><a class="reference internal" href="#la-bendita-instancia">La bendita instancia</a></li>
<li><a class="reference internal" href="#consideraciones-y-conceptos">Consideraciones y conceptos</a><ul>
<li><a class="reference internal" href="#shell"><em>Shell</em></a></li>
<li><a class="reference internal" href="#terminal"><em>Terminal</em></a></li>
<li><a class="reference internal" href="#prompt"><em>Prompt</em></a></li>
<li><a class="reference internal" href="#comando"><em>Comando</em></a></li>
<li><a class="reference internal" href="#opcion"><em>Opción</em></a></li>
<li><a class="reference internal" href="#argumento"><em>Argumento</em></a></li>
<li><a class="reference internal" href="#combinaciones"><em>Combinaciones</em></a></li>
<li><a class="reference internal" href="#path"><code class="code docutils literal notranslate"><span class="pre">$PATH</span></code></a></li>
<li><a class="reference internal" href="#uso-de-mayusculas-y-minusculas"><em>Uso de</em> <strong>mayúsculas</strong> <em>y</em> <strong>minúsculas</strong></a></li>
<li><a class="reference internal" href="#uso-de-caracteres-especiales"><em>Uso de caracteres especiales</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#comandos-basicos">Comandos básicos</a><ul>
<li><a class="reference internal" href="#ls"><code class="code docutils literal notranslate"><span class="pre">ls</span></code></a></li>
<li><a class="reference internal" href="#cd"><code class="code docutils literal notranslate"><span class="pre">cd</span></code></a></li>
<li><a class="reference internal" href="#mkdir"><code class="code docutils literal notranslate"><span class="pre">mkdir</span></code></a></li>
<li><a class="reference internal" href="#cp"><code class="code docutils literal notranslate"><span class="pre">cp</span></code></a></li>
<li><a class="reference internal" href="#mv"><code class="code docutils literal notranslate"><span class="pre">mv</span></code></a></li>
<li><a class="reference internal" href="#rm"><code class="code docutils literal notranslate"><span class="pre">rm</span></code></a></li>
<li><a class="reference internal" href="#cat"><code class="code docutils literal notranslate"><span class="pre">cat</span></code></a></li>
<li><a class="reference internal" href="#less"><code class="code docutils literal notranslate"><span class="pre">less</span></code></a></li>
<li><a class="reference internal" href="#head"><code class="code docutils literal notranslate"><span class="pre">head</span></code></a></li>
<li><a class="reference internal" href="#tail"><code class="code docutils literal notranslate"><span class="pre">tail</span></code></a></li>
<li><a class="reference internal" href="#wc"><code class="code docutils literal notranslate"><span class="pre">wc</span></code></a></li>
<li><a class="reference internal" href="#scp"><code class="code docutils literal notranslate"><span class="pre">scp</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parseando"><span class="xref std std-doc">Parseando</span></a><ul>
<li><a class="reference internal" href="#id2">Introducción</a></li>
<li><a class="reference internal" href="#grep"><code class="code docutils literal notranslate"><span class="pre">grep</span></code></a></li>
<li><a class="reference internal" href="#cut"><code class="code docutils literal notranslate"><span class="pre">cut</span></code></a></li>
<li><a class="reference internal" href="#sort"><code class="code docutils literal notranslate"><span class="pre">sort</span></code></a></li>
<li><a class="reference internal" href="#redireccion">Redirección: <code class="code docutils literal notranslate"><span class="pre">|</span></code></a></li>
<li><a class="reference internal" href="#id3">Redirección: <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code> &amp; <code class="code docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></a></li>
<li><a class="reference internal" href="#avanzado-awk">Avanzado: <code class="code docutils literal notranslate"><span class="pre">awk</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ngs"><span class="xref std std-doc">NGS</span></a><ul>
<li><a class="reference internal" href="#id4">Introducción</a></li>
<li><a class="reference internal" href="#aspectos-generales-de-la-secuenciacion-masiva">Aspectos generales de la secuenciación masiva</a></li>
<li><a class="reference internal" href="#como-se-obtiene-un-exoma">Cómo se obtiene un exoma?</a></li>
<li><a class="reference internal" href="#evolucion-en-los-costos-de-secuenciacion-y-comparacion-de-plataformas">Evolución en los costos de secuenciación y comparación de plataformas</a></li>
<li><a class="reference internal" href="#secuenciacion-illumina">Secuenciación Illumina</a></li>
<li><a class="reference internal" href="#calidad-de-la-secuenciacion">Calidad de la secuenciación</a></li>
<li><a class="reference internal" href="#fastqc">FastQC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#burrows-wheeler-transform"><span class="xref std std-doc">Burrows Wheeler Transform</span></a><ul>
<li><a class="reference internal" href="#before-we-start"><em>Before we start</em></a></li>
<li><a class="reference internal" href="#id5">Introducción</a></li>
<li><a class="reference internal" href="#alineamiento-de-lecturas-sobre-un-genoma">Alineamiento de lecturas sobre un genoma</a></li>
<li><a class="reference internal" href="#transformada-de-burrows-wheeler">Transformada de Burrows-Wheeler</a></li>
<li><a class="reference internal" href="#tries-y-busqueda-por-backtracking"><em>Tries</em> y búsqueda por <em>backtracking</em></a></li>
<li><a class="reference internal" href="#formatos-de-salida-sam">Formatos de salida: SAM</a></li>
<li><a class="reference internal" href="#flag">FLAG</a></li>
<li><a class="reference internal" href="#concise-idiosyncratic-gapped-alignment-report-cigar-para-los-amigos">Concise Idiosyncratic Gapped Alignment Report (CIGAR para los amigos)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manejo-de-archivos-sam-bam-bed-vcf"><span class="xref std std-doc">Manejo de archivos SAM/BAM/BED/VCF</span></a><ul>
<li><a class="reference internal" href="#id6"><em>Before we start</em></a></li>
<li><a class="reference internal" href="#comandos-del-dia-4">Comandos del día 4</a></li>
<li><a class="reference internal" href="#comandos-del-dia-5">Comandos del día 5</a></li>
<li><a class="reference internal" href="#formatos-formatos-everywhere">Formatos… formatos everywhere</a></li>
<li><a class="reference internal" href="#contacto">Contacto</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Call me by your reads</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Call me by your reads</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="call-me-by-your-reads">
<h1>Call me by your reads<a class="headerlink" href="#call-me-by-your-reads" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="crash-course-de-llamado-de-variantes-genomicas">
<h2>Crash course de llamado de variantes genómicas<a class="headerlink" href="#crash-course-de-llamado-de-variantes-genomicas" title="Enlazar permanentemente con este título">¶</a></h2>
<a class="reference internal image-reference" href="_images/not_a_snp.png"><img alt="&quot;Not a SNP&quot;" class="align-center" src="_images/not_a_snp.png" style="width: 600px;" /></a>
</div>
<div class="section" id="introduccion">
<h2>Introducción<a class="headerlink" href="#introduccion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A lo largo de las secuencias genómicas, los organismos de una misma especie pueden presentar variaciones que van desde un nucleótido hasta regiones cromosómicas complejas.</p>
<p>Los cambios pequeños que van desde 1 hasta 100 nucleótidos representan una fuente de variación entre organismos de una misma especie con la suficiente tolerancia para ocurrir con frecuencias elevadas (SNPs) y con los efectos suficientemente grandes para poder ser detectados como mecanismos causales de enfermedades o asociados a fenotipos específicos</p>
<p>El llamado de variantes genéticas a partir de datos de secuenciación masiva ha sido empleado primariamente en humanos con la finalidad de encontrar mecanismos de patogenicidad en enfermedades hereditarias, pero tambien ha sido empleado para análisis de variantes comunes asociadas a fenotipos específicos no deletéreos (GWAS).</p>
<dl>
<dt>Debido a su relación costo beneficio y a su amplia utilidad, este tipo de metodologías ha sido empleado en genotipifcación de otros organismos además del humano:</dt><dd><ul class="simple">
<li><p>En <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/29618499/">virus</a> como el virus de inmunodeficiencia humana se pueden detectar variantes asociadas a la resistencia a tratamiento antiretroviral</p></li>
<li><p>En <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/30895217/">microorganismos</a> patógenos se puede realizar la detección de variantes asociadas a resistencia a antibióticos</p></li>
<li><p>En <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/31541577/">animales</a> se puede realizar la detección de variantes para estudios de conservacion y de mejoramiento de razas (como en ganado y en crianza de perritos)</p></li>
<li><p>En <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/32814806/">plantas</a> se puede realizar la genotipificación de variedades específicas para selección y mejoramiento de cultivos (como en trigo, maíz, chile y frijol)</p></li>
</ul>
</dd>
<dt>El procedimiento general consiste en:</dt><dd><ol class="arabic" start="0">
<li><dl>
<dt>Un experimento de secuenciación</dt><dd><ul class="simple">
<li><p>Puede ser secuenciación de genoma completo</p></li>
<li><p>Puede ser secuenciación de regiones específicas</p></li>
<li><p>Puede ser secuenciación de regiones aleatorias</p></li>
</ul>
<img alt="_images/GBS.png" src="_images/GBS.png" />
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Alineamiento de las lecturas a un genoma de referencia</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/25056481/">…</a> ó no</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Llamado de variantes</dt><dd><ul class="simple">
<li><p>Pueden llamarse variantes por individuo</p></li>
<li><p>Pueden llamarse variantes por conjunto de individuos</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>Genotipificación y faseo de los alelos</dt><dd><ul class="simple">
<li><p>Construcción de haplotipos basado en secuenciación (usando <em>long reads</em>)</p></li>
<li><p>Construcción de haplotipos basado en relaciones interindividuales (usando árboles genealógicos)</p></li>
</ul>
<img alt="_images/data_flow.png" src="_images/data_flow.png" />
</dd>
</dl>
</li>
</ol>
</dd>
<dt>En este curso aprenderás a usar comandos básicos de linux y <a class="reference external" href="https://gatk.broadinstitute.org/">GATK4</a> para el llamado de variantes genómicas a partir de datos de secuenciación masiva obtenidos de muestras humanas por individuo</dt><dd><ul class="simple">
<li><p>La documentación de todo el curso estará disponible conforme avance el curso en <a class="reference external" href="https://call-me-by-your-reads.readthedocs.io/en/latest/">readthedocs.org</a></p></li>
<li><p>Mándanos tus preguntas, comentarios, sugerencias y quejas a nuestro canal en <a class="reference external" href="https://discord.com/channels/724665563212939285/798223051253874709">discord</a></p></li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="linux">
<h1><a class="reference internal" href="linux.html"><span class="doc">Linux</span></a><a class="headerlink" href="#linux" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="id1">
<h2>Introducción<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Existen múltiples programas para el llamado de variantes, no obstante la gran mayoria no puede ser ejecutada en ambientes windows. En consecuencia, es importante estar familiarizado con el uso de sistemas unix/linux como puede ser Mac-OSX o Ubuntu linux.</p>
<p>Adicionalmente, muchos de los programas para el llamado de variantes no cuenta con una interfáz gráfica de usuario, por ello, es importante aprender a usar la línea de comandos con fluidez</p>
</div>
<div class="section" id="la-bendita-instancia">
<h2>La bendita instancia<a class="headerlink" href="#la-bendita-instancia" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En esta ocasión te preparamos una máquina especial a la que puedes accesar en el horario del curso. Es una instancia en Amazon Web Services y de ahora en adelante nos referiremos a esta máquina como «la instancia»
Para ingresar a la instancia necesitas una llave que te otorgamos en el archivo «atg.pem». <strong>no necesitas abrir este archivo</strong>, solamente debes ponerlo en tu carpeta personal</p>
<ul>
<li><p>Si usas windows, así puedes accesar a tu carpeta personal:</p>
<blockquote>
<div><ul class="simple">
<li><p>Abre un explorador de archivos</p></li>
<li><p>Ve a la carpeta «Este equipo»</p></li>
<li><p>Ve a la carpeta «C:\»</p></li>
<li><p>Ve a la carpeta «Users» (o usuarios, dependiendo de tu equipo)</p></li>
<li><p>Ve a la carpeta con tu nombre de usuario</p></li>
</ul>
<a class="reference internal image-reference" href="_images/dianolasa_home.jpg"><img alt="&quot;Así se ve el home de &#64;dianolasa&quot;" src="_images/dianolasa_home.jpg" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Si usas linux, así puedes accesar a tu carpeta personal:</p>
<blockquote>
<div><ul class="simple">
<li><p>Abre un explorador de archivos</p></li>
<li><p>En la barra lateral podrás encontrar tu carpeta personal con el icono de una casa</p></li>
</ul>
<a class="reference internal image-reference" href="_images/vflorelo_home.png"><img alt="&quot;Así se ve el home de &#64;vflorelo&quot;" src="_images/vflorelo_home.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Si usas mac, así puedes accesar a tu carpeta personal:</p>
<blockquote>
<div><ul class="simple">
<li><p>Abre tu explorador de archivos (Finder)</p></li>
<li><p>Dirigete a la carpeta marcada con el icono de una casa</p></li>
</ul>
<a class="reference internal image-reference" href="_images/zorbax_home.jpg"><img alt="&quot;Así se ve el home de &#64;zorbax&quot;" src="_images/zorbax_home.jpg" style="width: 600px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>No siempre está habilitado el directorio home en finder, de modo que si no lo ves, checa la configuración de finder</p>
<a class="reference internal image-reference" href="_images/zorbax_finder_opts.jpg"><img alt="&quot;Checa tu finder si no encuentras tu home&quot;" src="_images/zorbax_finder_opts.jpg" style="height: 200px;" /></a>
</div>
</div></blockquote>
</li>
</ul>
<p>Ya que tengas tu archivo atg.pem en tu carpeta personal, no la muevas ni le cambies el nombre.
Ahora vamos a abrir la terminal</p>
<ul class="simple">
<li><p>Si usas windows, inicia una sesión con mobaxterm</p></li>
<li><p>Si usas linux, abre tu terminal</p></li>
<li><p>Si usas mac, abre tu terminal en Aplicaciones -&gt; Utilidades -&gt; Terminal</p></li>
</ul>
<p>A continuación vamos a blindar nuestra llave para que funcione adecuadamente</p>
<p><code class="code docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">400</span> <span class="pre">atg.pem</span></code></p>
<p>Una vez hecho esto, vamos a iniciar sesión en la instancia (<strong>recuerda cambiar «vflorelo» por tu nombre de usuario</strong>)</p>
<p><code class="code docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-i</span> <span class="pre">atg.pem</span> <span class="pre">vflorelo&#64;atgenomics.ddns.net</span></code></p>
<div class="admonition-nota admonition">
<p class="admonition-title">Nota</p>
<p>Es importante que distingas:</p>
<ul class="simple">
<li><p>Cuando estás trabajando en la instancia, la barrita en la terminal dice atgenomics</p></li>
<li><p>Cuando estás trabajando en una terminal local, la barrita no dice atgenomics</p></li>
</ul>
<a class="reference internal image-reference" href="_images/local_remote.png"><img alt="&quot;Recuerda, el prompt es tu amigo&quot;" src="_images/local_remote.png" style="width: 600px;" /></a>
</div>
</div>
<div class="section" id="consideraciones-y-conceptos">
<h2>Consideraciones y conceptos<a class="headerlink" href="#consideraciones-y-conceptos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Para el uso óptimo de la línea de comandos debemos tener en consideración las siguientes definiciones y precauciones</p>
</div>
<div class="section" id="shell">
<h3><em>Shell</em><a class="headerlink" href="#shell" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Es el intérprete entre el usuario y las aplicaciones</p>
<ul class="simple">
<li><p>El shell recibe una entrada a manera de comandos</p></li>
<li><p>Estos comandos operan a través de aplicaciones</p></li>
<li><p>Las aplicaciones interactuan con el <em>kernel</em> controlando el procesador, la memoria RAM y el disco de la máquina</p></li>
</ul>
</div>
<div class="section" id="terminal">
<h3><em>Terminal</em><a class="headerlink" href="#terminal" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La terminal o línea de comandos es una interfáz no gráfica con la cúal el usuario puede interactuar con el sistema. A pesar de su simpleza es una interfaz sumamente poderosa y eficiente, ya que nos permite ver que es lo que está ocurriendo tras bambalinas mientras un programa se está ejecutando. Es un estándar en el cómputo y seguirá siendolo por mucho tiempo más.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/commitstrip_cli.jpg"><img alt="Your friendly neighbour the terminal" src="_images/commitstrip_cli.jpg" style="width: 600px;" /></a>
</div></blockquote>
</div>
<div class="section" id="prompt">
<h3><em>Prompt</em><a class="headerlink" href="#prompt" title="Enlazar permanentemente con este título">¶</a></h3>
<dl>
<dt>El <em>prompt</em> es la linea en la terminal que nos indica que nuestra consola está responsiva y que puede aceptar comandos del usuario</dt><dd><div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>Si no hay prompt no podemos mandar comandos</p>
</div>
<a class="reference internal image-reference" href="_images/terminal_01_prompt.png"><img alt="No prompt, no soup for you!" src="_images/terminal_01_prompt.png" style="width: 600px;" /></a>
</dd>
</dl>
</div>
<div class="section" id="comando">
<h3><em>Comando</em><a class="headerlink" href="#comando" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un comando es la primera palabra que va después del prompt (o después de un pipe &quot;|&quot;, eso lo veremos en parseo ), un comando es esencialmente un elemento ejecutable que puede ser un programa binario o un script</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>El comando debe estar presente en el <code class="code docutils literal notranslate"><span class="pre">$PATH</span></code> para que la terminal lo pueda ejecutar</p>
</div>
<a class="reference internal image-reference" href="_images/terminal_02_command.png"><img alt="_images/terminal_02_command.png" src="_images/terminal_02_command.png" style="width: 600px;" /></a>
</div></blockquote>
</div>
<div class="section" id="opcion">
<h3><em>Opción</em><a class="headerlink" href="#opcion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ciertos comandos y programas pueden comportarse distinto si le pasamos una o más opciones.</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Las opciones se especifican con el signo “-” o con los signos “--”</p>
</div>
<a class="reference internal image-reference" href="_images/terminal_03_option.png"><img alt="option" src="_images/terminal_03_option.png" style="width: 600px;" /></a>
</div></blockquote>
</div>
<div class="section" id="argumento">
<h3><em>Argumento</em><a class="headerlink" href="#argumento" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un argumento es una o más palabras que vienen después de un comando, pueden ir antes o después de una opción (o no llevar opciones incluso)</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Los argumentos no llevan “-” ni “--” y en ocasiones conviene delimitarlos con comillas</p>
</div>
<a class="reference internal image-reference" href="_images/terminal_04_argument.png"><img alt="argument" src="_images/terminal_04_argument.png" style="width: 600px;" /></a>
</div></blockquote>
</div>
<div class="section" id="combinaciones">
<h3><em>Combinaciones</em><a class="headerlink" href="#combinaciones" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En muchas ocasiones necesitaremos de opciones y de argumentos de modo que es indispensable saber como combinarlos</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>El orden de las opciones y argumentos es fundamental en la ejecución de los comandos que usaremos a partir del día 3</p>
</div>
<a class="reference internal image-reference" href="_images/terminal_05_opt_arg.png"><img alt="combination" src="_images/terminal_05_opt_arg.png" style="width: 600px;" /></a>
</div></blockquote>
</div>
<div class="section" id="path">
<h3><code class="code docutils literal notranslate"><span class="pre">$PATH</span></code><a class="headerlink" href="#path" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En unix/linux la variable de entorno <code class="code docutils literal notranslate"><span class="pre">$PATH</span></code> contiene el conjunto de directorios que alberga aplicaciones en nuestro sistema</p>
<blockquote>
<div><div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>Es una variable muy sensible, y moverla sin conocimiento puede tener consecuencias que afecten la sesión del usuario, hay que modificarla lo menos posible</p>
</div>
<a class="reference internal image-reference" href="_images/path.png"><img alt="path" src="_images/path.png" style="width: 600px;" /></a>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Si queremos instalar un programa nuevo, lo podemos colocar en cualquiera de las carpetas enlistadas anteriormente y lo podemos invocar desde cualquier sitio en nuestra terminal</p>
</div>
</div></blockquote>
</div>
<div class="section" id="uso-de-mayusculas-y-minusculas">
<h3><em>Uso de</em> <strong>mayúsculas</strong> <em>y</em> <strong>minúsculas</strong><a class="headerlink" href="#uso-de-mayusculas-y-minusculas" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>Los sistemas unix/linux son sensibles al uso de <strong>mayúsculas</strong> y <strong>minúsculas</strong>!</p>
<p>Es importante revisar siempre lo que ingresas en la terminal antes de mandar cualquier instrucción</p>
</div>
</div>
<div class="section" id="uso-de-caracteres-especiales">
<h3><em>Uso de caracteres especiales</em><a class="headerlink" href="#uso-de-caracteres-especiales" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Existen caracteres con un significado específico del sistema, en consecuencia, se deben tratar de forma especial.</p>
<p>Estos caracteres son los siguientes y por lo general los ubicas en tu teclado en la barra numérica:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>&#64;</p></td>
<td rowspan="2"><p>#</p></td>
<td rowspan="2"><p>$</p></td>
<td rowspan="2"><p>%</p></td>
<td rowspan="2"><p>^</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>&amp;</p></td>
<td rowspan="2"><p>*</p></td>
<td rowspan="2"><p>-</p></td>
<td rowspan="2"><p>+</p></td>
<td rowspan="2"><p>=</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>( )</p></td>
<td rowspan="2"><p>{ }</p></td>
<td rowspan="2"><p>[ ]</p></td>
<td rowspan="2"><p>;</p></td>
<td rowspan="2"><p>:</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>,</p></td>
<td rowspan="2"><p>'</p></td>
<td rowspan="2"><p>&quot;</p></td>
<td rowspan="2"><p>&lt;</p></td>
<td rowspan="2"><p>&gt;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>.</p></td>
<td rowspan="2"><p>/</p></td>
<td rowspan="2"><p>?</p></td>
<td rowspan="2"><p>\</p></td>
<td rowspan="2"><p>|</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Si alguno de nuestros archivos tiene espacios en su nombre (o caracteres especiales), la terminal necesita saber que estos espacios son parte del mismo argumento</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat mi archivo.txt
cat: mi: No such file or directory
cat: archivo.txt: No such file or directory
</pre></div>
</div>
</div>
<p>Cuando hicimos el comando <code class="code docutils literal notranslate"><span class="pre">cat</span> <span class="pre">mi</span> <span class="pre">archivo.txt</span></code>, lo que está ocurriendo es que <code class="code docutils literal notranslate"><span class="pre">cat</span></code> espera dos archivos, un archivo llamado &quot;mi&quot;, y un archivo llamado &quot;archivo.txt&quot;.</p>
<p>Al no existir estos archivos, la terminal nos arroja un mensaje de error</p>
<p>Esto lo solucionamos de dos formas:</p>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<ul>
<li><p>Encerrando 'mi archivo.txt' entre comillas (dobles o sencillas):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat &quot;mi archivo.txt&quot;
Hola mundo!
</pre></div>
</div>
</li>
<li><p><em>Escapando</em> el espacio con el simbolo “\”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat mi\ archivo.txt
Hola mundo
</pre></div>
</div>
</li>
</ul>
<p>Ambas soluciones hacen que «mi archivo.txt» sea un solo argumento en vez de dos.</p>
<p>Estas soluciones funcionan también para el resto de los caracteres especiales.</p>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="comandos-basicos">
<h2>Comandos básicos<a class="headerlink" href="#comandos-basicos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En esta sección encontraremos comandos básicos para el manejo de archivos, es indispensable que tengamos familiaridad con estos comandos antes de continuar con la manipulación de archivos</p>
<div class="section" id="ls">
<h3><code class="code docutils literal notranslate"><span class="pre">ls</span></code><a class="headerlink" href="#ls" title="Enlazar permanentemente con este título">¶</a></h3>
<p>List, nos indica que elementos hay en el directorio actual</p>
<div class="toggle admonition">
<p class="admonition-title">Opciones de <code class="code docutils literal notranslate"><span class="pre">ls</span></code></p>
<ul class="simple">
<li><p>Listado de los archivos en formato extendido ( <code class="code docutils literal notranslate"><span class="pre">-l</span></code> )</p></li>
<li><p>Listado de los archivos en formato extendido en lenguaje humano ( <code class="code docutils literal notranslate"><span class="pre">-l</span> <span class="pre">-h</span></code> )</p></li>
<li><p>Listado de los archivos incluido archivos ocultos ( <code class="code docutils literal notranslate"><span class="pre">-a</span></code> )</p></li>
<li><p>Listado de los archivos en orden cronológico ( <code class="code docutils literal notranslate"><span class="pre">-l</span> <span class="pre">-h</span> <span class="pre">-t</span></code> )</p></li>
<li><p>Listado de los archivos en orden alfanumérico reverso ( <code class="code docutils literal notranslate"><span class="pre">-l</span> <span class="pre">-h</span> <span class="pre">-r</span></code> )</p></li>
<li><p>Listado de los archivos en orden cronológico reverso ( <code class="code docutils literal notranslate"><span class="pre">-l</span> <span class="pre">-h</span> <span class="pre">-r</span> <span class="pre">-t</span></code> )</p></li>
</ul>
</div>
</div>
<div class="section" id="cd">
<h3><code class="code docutils literal notranslate"><span class="pre">cd</span></code><a class="headerlink" href="#cd" title="Enlazar permanentemente con este título">¶</a></h3>
<p><em>Change Directory</em> nos cambia al directorio que le indiquemos</p>
<div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">cd</span></code></p>
<ul>
<li><p>Dirigirse a un directorio dentro del directorio actual:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ ls
dia_01

$ cd dia_01

$ pwd
/home/vflorelo/dia_01

$ ls
Homo_sapiens_GRCh38.fasta.fai
test_data_variants.tsv
test_data_variants.vcf
</pre></div>
</div>
</li>
<li><p>Dirigirse a un directorio usando una ruta absoluta:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ cd /home/vflorelo/dia_01

$ pwd
/home/vflorelo/dia_01

$ cd /usr/local/bioinformatics

$ pwd
/usr/local/bioinformatics

$ ls
bcftools
bin
bwa
data
htslib
include
lib
libexec
samtools
share

$ cd /home/vflorelo/dia_01

$ pwd
/home/vflorelo/dia_01
</pre></div>
</div>
</li>
<li><p>Dirigirse al directorio superior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo/dia_01

$ cd ..

$ pwd
/home/vflorelo
</pre></div>
</div>
</li>
<li><p>Dirigirse a un directorio usando una ruta relativa:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo/dia_01

$ cd ../dia_02

$ pwd
/home/vflorelo/dia_02
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="mkdir">
<h3><code class="code docutils literal notranslate"><span class="pre">mkdir</span></code><a class="headerlink" href="#mkdir" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Make Directory, crea un directorio con el nombre que le indiquemos</p>
<div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">mkdir</span></code></p>
<ul>
<li><p>Crear a un directorio dentro del directorio actual:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ ls
dia_01

$ mkdir dia_02

$ ls
dia_01
dia_02
</pre></div>
</div>
</li>
<li><p>Crear un directorio usando una ruta absoluta:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ mkdir /home/vflorelo/dia_03

$ pwd
/home/vflorelo

$ ls
dia_01
dia_02
dia_03
</pre></div>
</div>
</li>
<li><p>Crear un directorio usando una ruta relativa:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo/dia_01

$ mkdir ../dia_04

$ cd ..

$ pwd
/home/vflorelo

$ ls
dia_01
dia_02
dia_03
dia_04
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="cp">
<h3><code class="code docutils literal notranslate"><span class="pre">cp</span></code><a class="headerlink" href="#cp" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Copy, copia un archivo a un directorio (o al mismo directorio pero con nombre diferente)</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">cp</span></code></p>
<ul>
<li><p>Copiar el contenido de un archivo a otro archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cp mi_archivo.txt mi_nuevo_archivo.txt
$ cat mi_nuevo_archivo.txt
Hola mundo!
</pre></div>
</div>
</li>
<li><p>Copiar el archivo desde el directorio actual a otro directorio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
mi_archivo.txt otro_directorio
$ ls otro_directorio

$ cp mi_archivo.txt otro_directorio
$ ls otro_directorio
mi_archivo.txt
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Si no existe el directorio “otro_directorio”, cp creará un nuevo <strong>archivo</strong> llamado “otro_directorio”</p>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="mv">
<h3><code class="code docutils literal notranslate"><span class="pre">mv</span></code><a class="headerlink" href="#mv" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Move, mueve un archivo de un lugar a otro (o le cambia el nombre al archivo)</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Modos de operacion de <code class="code docutils literal notranslate"><span class="pre">mv</span></code></p>
<ul>
<li><p>Cambia el nombre de un archivo a otro archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mv mi_archivo.txt mi_nuevo_archivo.txt

$ cat mi_nuevo_archivo.txt
Hola mundo!

$ cat mi_archivo.txt
cat: mi_archivo.txt: No such file or directory
</pre></div>
</div>
</li>
<li><p>Mover el archivo desde el directorio actual a otro directorio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
mi_archivo.txt otro_directorio

$ ls otro_directorio

$ mv mi_archivo.txt otro_directorio

$ ls
otro_directorio

$ ls otro_directorio
mi_archivo.txt
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Si no existe el directorio «otro_directorio», mv le cambiará el nombre a “mi_archivo.txt” y se llamará “otro_directorio”, “mi_archivo.txt” no existirá más</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>Si ya existe un <strong>archivo</strong> con el nombre que le indiquemos a <code class="code docutils literal notranslate"><span class="pre">mv</span></code> como destino, perderemos la información del archivo destino:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
archivo_equis.txt
tesis_final.docx

$ cat archivo_equis.txt
Este archivo contiene basura

$ mv archivo_equis.txt tesis_final.docx

$ ls
tesis_final.docx

$ cat tesis_final.docx
Este archivo contiene basura
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="rm">
<h3><code class="code docutils literal notranslate"><span class="pre">rm</span></code><a class="headerlink" href="#rm" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Remove, elimina el archivo o directorio indicado</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Modos de operacion de <code class="code docutils literal notranslate"><span class="pre">rm</span></code></p>
<ul>
<li><p>elimina un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
mi_archivo.txt mi_nuevo_archivo.txt

$ rm mi_archivo.txt

$ ls
mi_nuevo_archivo.txt
</pre></div>
</div>
</li>
<li><p>Elimina un directorio con todos sus elementos:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
otro_directorio

$ ls otro_directorio
mi_archivo.txt

$ rm -r otro_directorio

$ ls otro_directorio
ls: cannot access &#39;otro_directorio&#39;: No such file or directory
</pre></div>
</div>
</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p><code class="code docutils literal notranslate"><span class="pre">rm</span></code> es un comando destructivo, si se borran los archivos <strong>no son recuperables</strong></p>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="cat">
<h3><code class="code docutils literal notranslate"><span class="pre">cat</span></code><a class="headerlink" href="#cat" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Concatenate, nos muestra el contenido de un archivo, o archivos</p>
</div>
<div class="section" id="less">
<h3><code class="code docutils literal notranslate"><span class="pre">less</span></code><a class="headerlink" href="#less" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Less nos muestra el contenido de un archivo, pero nos lo muestra, una pantalla a la vez</p>
</div>
<div class="section" id="head">
<h3><code class="code docutils literal notranslate"><span class="pre">head</span></code><a class="headerlink" href="#head" title="Enlazar permanentemente con este título">¶</a></h3>
<dl>
<dt>Head, nos da las primeras N líneas de un archivo</dt><dd><div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">head</span></code></p>
<ul>
<li><p>Muestra las primeras 10 líneas de un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ head Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
</pre></div>
</div>
</li>
<li><p>Muestra las primeras 2 líneas de un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ head -n2 Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
</pre></div>
</div>
</li>
<li><p>Muestra las primeras líneas de un archivo exceptuando las ultimas 2 líneas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ head -n-2 Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
X       156040895       2916073361      70      71
</pre></div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="section" id="tail">
<h3><code class="code docutils literal notranslate"><span class="pre">tail</span></code><a class="headerlink" href="#tail" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Tail, nos da las últimas N líneas de un archivo</p>
<div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">tail</span></code></p>
<ul>
<li><p>Muestra las últimas 10 líneas de un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tail Homo_sapiens_GRCh38.fasta.fai
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
MT      16569   3132388394      70      71
</pre></div>
</div>
</li>
<li><p>Muestra las últimas 2 lineas de un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tail -n2 Homo_sapiens_GRCh38.fasta.fai
Y       57227415        3074343428      70      71
MT      16569   3132388394      70      71
</pre></div>
</div>
</li>
<li><p>Muestra las últimas líneas de un archivo exceptuando las primeras 2 líneas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tail -n+2 Homo_sapiens_GRCh38.fasta.fai
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
MT      16569   3132388394      70      71
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="wc">
<h3><code class="code docutils literal notranslate"><span class="pre">wc</span></code><a class="headerlink" href="#wc" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Word count, nos indica el número de líneas, palabras y caracteres de un archivo o de un <em>string</em></p>
<div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">wc</span></code></p>
<ul>
<li><p>Nos da un resumen del contenido de un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wc Homo_sapiens_GRCh38.fasta.fai
 25 125 715 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</li>
<li><p>Cuenta el número de líneas en un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wc -l Homo_sapiens_GRCh38.fasta.fai
 25 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</li>
<li><p>Cuenta el número de palabras en un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wc -w Homo_sapiens_GRCh38.fasta.fai
 125 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</li>
<li><p>Cuenta el número de caracteres en un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wc -c Homo_sapiens_GRCh38.fasta.fai
 715 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="scp">
<h3><code class="code docutils literal notranslate"><span class="pre">scp</span></code><a class="headerlink" href="#scp" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El comando <code class="code docutils literal notranslate"><span class="pre">scp</span></code> nos permite al igual que <code class="code docutils literal notranslate"><span class="pre">cp</span></code>, copiar archivos desde un origen hacia un destino, no obstante, lo hace a través de servidores remotos.</p>
<p>Este comando combina las bondades de <code class="code docutils literal notranslate"><span class="pre">cp</span></code> con los protocolos de seguridad de <code class="code docutils literal notranslate"><span class="pre">ssh</span></code></p>
<p>Por ello, el uso de <code class="code docutils literal notranslate"><span class="pre">scp</span></code> es muy similar al de <code class="code docutils literal notranslate"><span class="pre">cp</span></code> y al de <code class="code docutils literal notranslate"><span class="pre">ssh</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ scp -i atg.pem vflorelo@atgenomics.ddns.net:/home/vflorelo/dia_01/Homo_sapiens_GRCh38.fasta.fai .
</pre></div>
</div>
<p>La construcción anterior nos permite copiar el archivo <cite>Homo_sapiens_GRCh38.fasta.fai</cite> desde el directorio <cite>/home/vflorelo/dia_01</cite> ubicado en el servidor <cite>atgenomics.ddns.net</cite> utilizando la llave <cite>atg.pem</cite></p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>A dónde lo va a copiar?</p>
<p>Noten al final de la construcción, el punto <code class="code docutils literal notranslate"><span class="pre">.</span></code> el cual especifica que copiará el archivo <cite>Homo_sapiens_GRCh38.fasta.fai</cite> hacia el directorio actual</p>
</div>
</div>
</div>
</div>
<div class="section" id="parseando">
<h1><a class="reference internal" href="parsing.html"><span class="doc">Parseando</span></a><a class="headerlink" href="#parseando" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="id2">
<h2>Introducción<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La finalidad de este curso es obtener un archivo de llamado de variantes (<em>Variant Calling File</em> por sus siglas en inglés) que tiene la siguiente estructura:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  g204</span>
        <span class="n">chr1</span>       <span class="mi">13417</span>   <span class="n">rs777038595</span>     <span class="n">C</span>       <span class="n">CGAGA</span>   <span class="mf">324.73</span>  <span class="n">PASS</span>    <span class="n">AC</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">AF</span><span class="o">=</span><span class="mf">0.500</span><span class="p">;</span><span class="n">AN</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">BaseQRankSum</span><span class="o">=</span><span class="mf">0.583</span><span class="p">;</span><span class="n">DB</span><span class="p">;</span><span class="n">DP</span><span class="o">=</span><span class="mi">26</span><span class="p">;</span><span class="n">ExcessHet</span><span class="o">=</span><span class="mf">3.0103</span><span class="p">;</span><span class="n">FS</span><span class="o">=</span><span class="mf">0.000</span><span class="p">;</span><span class="n">MLEAC</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">MLEAF</span><span class="o">=</span><span class="mf">0.500</span><span class="p">;</span><span class="n">MQ</span><span class="o">=</span><span class="mf">22.21</span><span class="p">;</span><span class="n">MQRankSum</span><span class="o">=-</span><span class="mf">0.032</span><span class="p">;</span><span class="n">QD</span><span class="o">=</span><span class="mf">12.49</span><span class="p">;</span><span class="n">ReadPosRankSum</span><span class="o">=-</span><span class="mf">2.185</span><span class="p">;</span><span class="n">SOR</span><span class="o">=</span><span class="mf">0.446</span><span class="p">;</span><span class="n">VQSLOD</span><span class="o">=</span><span class="mf">0.698</span><span class="p">;</span><span class="n">culprit</span><span class="o">=</span><span class="n">ReadPosRankSum</span> <span class="n">GT</span><span class="p">:</span><span class="n">AD</span><span class="p">:</span><span class="n">DP</span><span class="p">:</span><span class="n">GQ</span><span class="p">:</span><span class="n">PL</span>  <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">99</span><span class="p">:</span><span class="mi">362</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">634</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Descripción extendida del formato vcf</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 11%" />
<col style="width: 85%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1: CHROM</p></td>
<td rowspan="2"><p>chr1</p></td>
<td rowspan="2"><p>Cromosoma en dónde se ubica la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2: POS</p></td>
<td rowspan="2"><p>13417</p></td>
<td rowspan="2"><p>Posición de la variante en el cromosoma</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>3: ID</p></td>
<td colspan="2" rowspan="2"><p>rs777038595             +Identificador de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>4: REF</p></td>
<td rowspan="2"><p>C</p></td>
<td rowspan="2"><p>Alelo de referencia</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>5: ALT</p></td>
<td rowspan="2"><p>CGAGA</p></td>
<td rowspan="2"><p>Alelo encontrado en la muestra</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>6: QUAL</p></td>
<td rowspan="2"><p>324.73</p></td>
<td rowspan="2"><p>Score de calidad de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>7: FILTER</p></td>
<td rowspan="2"><p>PASS</p></td>
<td rowspan="2"><p>Flag de calidad de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="34"><p>8:INFO</p></td>
<td rowspan="2"><p>AC=1;</p></td>
<td rowspan="2"><p>Número de alelos alternos encontrados</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AF=0.500;</p></td>
<td rowspan="2"><p>Frecuencia alelica (alelo alterno)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AN=2;</p></td>
<td rowspan="2"><p>Número total de alelos para una variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>BaseQRankSum=0.583</p></td>
<td rowspan="2"><p>Z-score de la calidad de las bases mapeadas en el alelo alterno vs el alelo de referencia empleando una prueba de Wilcoxon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DB;</p></td>
<td rowspan="2"><p>Indica si la variante pertenece a una base de datos (dbSNP)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DP=26;</p></td>
<td rowspan="2"><p>número de lecturas mapeadas en la posición de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ExcessHet=3.0103;</p></td>
<td rowspan="2"><p>p-value en escala Phred para una prueba exacta de exceso de heterocigosidad</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>FS=0.000;</p></td>
<td rowspan="2"><p>P-value ajustado para determinar sesgo hacía una cadena de DNA empleando una prueba exacta de Fisher</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MLEAC=1;</p></td>
<td rowspan="2"><p>Máxima verosimilitud esperada para el número de alelos observados (depende del número de muestras).</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MLEAF=0.500;</p></td>
<td rowspan="2"><p>Máxima verosimilitud esperada para las frecuencias alélicas (depende del número de muestras).</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MQ=22.21;</p></td>
<td rowspan="2"><p>Calidad media de mapeo en la posición de la variante.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MQRankSum=-0.032;</p></td>
<td rowspan="2"><p>Z-score de la calidad de mapeo las bases alíneadas en el alelo alterno vs el alelo de referencia empleando una prueba de Wilcoxon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>QD=12.49;</p></td>
<td rowspan="2"><p>Confianza del alelo observado (Quality over depth)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ReadPosRankSum=-2.185;</p></td>
<td rowspan="2"><p>Z-score del sesgo posicional (con respecto de la longitud de la lectura) del alelo alternativo vs el alelo de referencia (depende del número de muestras)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>SOR=0.446;</p></td>
<td rowspan="2"><p>Suma simétrica de la razón de momios del número de lecturas que presentan la variante cerca del final de la lectura, vs las lecturas que la presentan cerca del inicio de la lectura.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>VQSLOD=0.698;</p></td>
<td rowspan="2"><p>Logaritmo de la razón de momios de que la variante sea verdadera vs que sea un falso positivo.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>culprit=ReadPosRankSum</p></td>
<td rowspan="2"><p>El descriptor que presentó la métrica más desfavorable</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="10"><p>9:FORMAT</p></td>
<td rowspan="2"><p>GT</p></td>
<td rowspan="2"><p>Genotipo</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AD</p></td>
<td rowspan="2"><p>Profundidad de los alelos observados (Ref,Alt)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DP</p></td>
<td rowspan="2"><p>Profundidad total (número de lecturas</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>GQ</p></td>
<td rowspan="2"><p>Calidad del genotipado</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>PL</p></td>
<td rowspan="2"><p>Verosimilitud de genotipos (Obs,Nul,Alt)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="10"><p>10:g204</p></td>
<td rowspan="2"><p>0/1</p></td>
<td rowspan="2"><p>Heterocigoto</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>15,11</p></td>
<td rowspan="2"><p>(C)15 reads + (CGAGA)11 reads</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>26</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>99</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>362,0,634</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>A través del uso de los siguientes comandos podemos filtrar éstos y otros archivos para optimizar y entender mejor lo que ocurre en el llamado de variantes
Para comenzar, vamos a descargar un archivo con el que podamos trabajar
<code class="code docutils literal notranslate"><span class="pre">wget</span> <span class="pre">https://github.com/vflorelo/Call-me-by-your-reads/</span></code></p>
</div>
<div class="section" id="grep">
<h2><code class="code docutils literal notranslate"><span class="pre">grep</span></code><a class="headerlink" href="#grep" title="Enlazar permanentemente con este título">¶</a></h2>
<p><strong>G</strong> lobally search for a <strong>R</strong> egular <strong>E</strong> xpression and <strong>P</strong> rint matching lines</p>
<p>Como su nombre lo indica, grep busca un patrón (o expresión regular) y nos entrega las líneas que contengan dicho patrón de búsqueda</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Opciones <code class="code docutils literal notranslate"><span class="pre">grep</span></code></p>
<ul>
<li><p>Buscar un patrón en un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep X Homo_sapiens_GRCh38.fasta.fai
X       156040895       2916073361      70      71
</pre></div>
</div>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">-w</span></code> Buscar un patrón en un archivo <em>si y solo si</em>, ocurre como <strong>palabra completa</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep 2 Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
MT      16569   3132388394      70      71

$ grep -w 2 Homo_sapiens_GRCh38.fasta.fai
2       242193529       252512975       70      71
</pre></div>
</div>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">-c</span></code> Buscar un patrón en un archivo pero en vez de entregar las líneas que contienen el patrón, entrega el <strong>número de líneas que contiene el patrón</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -c 2 Homo_sapiens_GRCh38.fasta.fai
24
</pre></div>
</div>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">-m</span></code> Buscar un patrón en un archivo y entregar como maximo m líneas</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -m2 2 Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
</pre></div>
</div>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">-n</span></code> Buscar un patrón en un archivo y mostrar el <strong>número de línea</strong> en la que ocurre el patrón de búsqueda:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -n X Homo_sapiens_GRCh38.fasta.fai
23:X    156040895       2916073361      70      71
</pre></div>
</div>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">-v</span></code> Buscar un patrón en un archivo y muestra las líneas <strong>que no contengan</strong> el patrón de búsqueda:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -v 2 Homo_sapiens_GRCh38.fasta.fai
6       170805979       1076358398      70      71
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>grep puede procesar muchos archivos, pero solo un patrón de búsqueda a la vez</p>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>La siguiente construcción es correcta:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep patrón archivo_1 archivo_2 archivo_3
</pre></div>
</div>
</div>
<div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>La siguiente construcción es incorrecta:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep patrón_1 patrón_2 patrón_3 archivo_1
</pre></div>
</div>
<p>En esta ultima construcción, grep interpretará <code class="code docutils literal notranslate"><span class="pre">patrón_2</span></code> &amp; <code class="code docutils literal notranslate"><span class="pre">patrón_3</span></code> como archivos, no como patrónes de búsqueda</p>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Las opciones de <code class="code docutils literal notranslate"><span class="pre">grep</span></code> son combinables, de modo que podemos tener:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -wv termino archivo

$ grep -wn termino archivo

$ grep -wc termino archivo
</pre></div>
</div>
<p>O las que se te ocurran, siempre y cuando tengan sentido ;)</p>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="cut">
<h2><code class="code docutils literal notranslate"><span class="pre">cut</span></code><a class="headerlink" href="#cut" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cut es una utilidad para separar columnas de un archivo tabular (como el vcf!)</p>
<p>Para linux todo es una tabla, sabiéndola separar, aquí una pequeña introducción, tomemos el siguiente texto:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">|</span><span class="n">b</span><span class="o">|</span><span class="n">c</span>
<span class="n">d</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="n">f</span>
<span class="n">g</span><span class="o">|</span><span class="n">h</span><span class="o">|</span><span class="n">i</span>
</pre></div>
</div>
<p>Podemos leerlo como una tabla de 3 filas y 3 columnas, separado por el signo “|”</p>
<p>Otro ejemplo, si copipegamos una tabla de excel a nuestro bloc de notas, tendremos un texto con la siguiente estructura:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>       <span class="n">b</span>       <span class="n">c</span>
<span class="n">d</span>       <span class="n">e</span>       <span class="n">f</span>
<span class="n">g</span>       <span class="n">h</span>       <span class="n">i</span>
</pre></div>
</div>
<p>Nuevamente podemos leerlo como una tabla de 3 filas y 3 columnas, separado por el signo invisible “\t”</p>
<p>Ahora si, habiendo tenido esta breve introducción:</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Modos de operación de <code class="code docutils literal notranslate"><span class="pre">cut</span></code></p>
<ul>
<li><p>Obtener la primera columna de un archivo tabular:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1 Homo_sapiens_GRCh38.fasta.fai
1
2
3
4
5
6
7
8
9
9
10
11
12
13
14
15
16
17
18
19
20
21
22
X
Y
MT
</pre></div>
</div>
</li>
<li><p>Obtener las primeras dos columnas de un archivo tabular:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1,2 Homo_sapiens_GRCh38.fasta.fai
1       248956422
2       242193529
3       198295559
4       190214555
5       181538259
6       170805979
7       159345973
8       145138636
9       138394717
10      133797422
11      135086622
12      133275309
13      114364328
14      107043718
15      101991189
16      90338345
17      83257441
18      80373285
19      58617616
20      64444167
21      46709983
22      50818468
X       156040895
Y       57227415
MT      16569
</pre></div>
</div>
</li>
<li><p>Obtener las primeras tres columnas de un archivo tabular</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Nota</p>
<p>podemos usar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1,2,3 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>o podemos usar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1-3 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Obtener las columnas 2 y 3 de un archivo tabular</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Nota</p>
<p>podemos usar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f2,3 Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>o podemos usar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1 --complement Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Obtener todas las columnas de un archivo empezando por la segunda</p>
<blockquote>
<div><div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Podemos hacerlo pidiendo un intervalo abierto:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f2- Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
<p>O podemos hacerlo excluyendo la columna que nos estorba:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -f1 --complement Homo_sapiens_GRCh38.fasta.fai
</pre></div>
</div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p><code class="code docutils literal notranslate"><span class="pre">cut</span></code> usa por default el tabulador (“\t”) como separador de campo. Qué pasa si mi tabla no está separada por tabuladores?</p>
<p>En ese escenario, podemos especificarle a <code class="code docutils literal notranslate"><span class="pre">cut</span></code> que use caracteres específicos como separadores de campo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat file_1
a|b|c
d|e|f
g|h|i

$ cut -d\| -f2
b
e
h
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Al igual que con <code class="code docutils literal notranslate"><span class="pre">grep</span></code>, las opciones de <code class="code docutils literal notranslate"><span class="pre">cut</span></code> pueden ser combinables para tener un mejor control de lo que nos va a entregar nuestra terminal</p>
<p>De este modo, las siguientes construcciones nos van a dar unicamente las columnas 2 y 6 de un archivo separado por comas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cut -d, -f2,6

$ cut -d, -f1,3-5 --complement
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Reto!</p>
<p>Cúal seria el resultado de las siguientes construcciones? El archivo lo encuentras en tu carpeta del dia_01. Mandanos por correo tus respuestas (y su explicación) y podrás ganar una sorpresa (limitado a 3 ganadores):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat archivo
A,B     C       D       E       F       G       H       I       J       K       L       M       N       O,P     Q       R,S,T   U       V       W       X

$ cut -f1,4-9,10,14,18- archivo

$ cut -f1,4-9,10,14,18- --complement archivo

$ cut -d, -f2,3 archivo

$ cut -d, -f2,3- archivo

$ cut -d, -f2,3 --complement archivo
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="sort">
<h2><code class="code docutils literal notranslate"><span class="pre">sort</span></code><a class="headerlink" href="#sort" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Sort puede ordenar un conjunto de líneas empleando algún criterio.</p>
<blockquote>
<div><div class="toggle admonition">
<p class="admonition-title">Modos de operacion de <code class="code docutils literal notranslate"><span class="pre">sort</span></code></p>
<div class="toggle admonition">
<p class="admonition-title">Ordenar un conjunto de líneas alfanumericamente</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort Homo_sapiens_GRCh38.fasta.fai
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
1       248956422       16      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
2       242193529       252512975       70      71
22      50818468        2864528898      70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
MT      16569   3132388394      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>En cómputo, el orden alfanumérico es algo truculento, 100 va antes que 10, y 10 va antes que 1.</p>
<p>De modo que ordenar líneas no es una tarea trivial</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Ordenar un conjunto de líneas numericamente</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort -n Homo_sapiens_GRCh38.fasta.fai
MT      16569   3132388394      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
1       248956422       16      70      71
2       242193529       252512975       70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>En cómputo, el orden numérico es sensible a la presencia de caracteres alfabéticos, por lo que para ordenar líneas adecuadamente se requiere limpiar los datos (que unicamente contengan un tipo de datos por columna o por campo) o de emplear otra estrategia</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Ordenar un conjunto de líneas como versionado de software</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort -V Homo_sapiens_GRCh38.fasta.fai
1       248956422       16      70      71
2       242193529       252512975       70      71
3       198295559       498166428       70      71
4       190214555       699294797       70      71
5       181538259       892226719       70      71
6       170805979       1076358398      70      71
7       159345973       1249604479      70      71
8       145138636       1411226840      70      71
9       138394717       1558438902      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
12      133275309       1971535983      70      71
13      114364328       2106715242      70      71
14      107043718       2222713363      70      71
15      101991189       2331286294      70      71
16      90338345        2434734517      70      71
17      83257441        2526363427      70      71
18      80373285        2610810278      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
MT      16569   3132388394      70      71
X       156040895       2916073361      70      71
Y       57227415        3074343428      70      71
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Ordenar de forma descendente un conjunto de líneas</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort -r Homo_sapiens_GRCh38.fasta.fai
Y       57227415        3074343428      70      71
X       156040895       2916073361      70      71
MT      16569   3132388394      70      71
9       138394717       1558438902      70      71
8       145138636       1411226840      70      71
7       159345973       1249604479      70      71
6       170805979       1076358398      70      71
5       181538259       892226719       70      71
4       190214555       699294797       70      71
3       198295559       498166428       70      71
22      50818468        2864528898      70      71
2       242193529       252512975       70      71
21      46709983        2817151612      70      71
20      64444167        2751786798      70      71
19      58617616        2692331770      70      71
18      80373285        2610810278      70      71
17      83257441        2526363427      70      71
16      90338345        2434734517      70      71
15      101991189       2331286294      70      71
14      107043718       2222713363      70      71
13      114364328       2106715242      70      71
1       248956422       16      70      71
12      133275309       1971535983      70      71
11      135086622       1834519535      70      71
10      133797422       1698810704      70      71
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Ordenar con base en alguna columna específica</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort -k2 Homo_sapiens_GRCh38.fasta.fai
15      101991189       2331286294      70      71
14      107043718       2222713363      70      71
13      114364328       2106715242      70      71
12      133275309       1971535983      70      71
10      133797422       1698810704      70      71
11      135086622       1834519535      70      71
9       138394717       1558438902      70      71
8       145138636       1411226840      70      71
X       156040895       2916073361      70      71
7       159345973       1249604479      70      71
MT      16569   3132388394      70      71
6       170805979       1076358398      70      71
5       181538259       892226719       70      71
4       190214555       699294797       70      71
3       198295559       498166428       70      71
2       242193529       252512975       70      71
1       248956422       16      70      71
21      46709983        2817151612      70      71
22      50818468        2864528898      70      71
Y       57227415        3074343428      70      71
19      58617616        2692331770      70      71
20      64444167        2751786798      70      71
18      80373285        2610810278      70      71
17      83257441        2526363427      70      71
16      90338345        2434734517      70      71
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Ordenar con opciones múltiples</p>
<p><code class="code docutils literal notranslate"><span class="pre">sort</span></code> al igual que <code class="code docutils literal notranslate"><span class="pre">cut</span></code> o <code class="code docutils literal notranslate"><span class="pre">grep</span></code> permite combinar opciones, siempre y cuando estas tengan sentido:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sort -n -r -k3 Homo_sapiens_GRCh38.fasta.fai
MT      16569   3132388394      70      71
Y       57227415        3074343428      70      71
X       156040895       2916073361      70      71
22      50818468        2864528898      70      71
21      46709983        2817151612      70      71
20      64444167        2751786798      70      71
19      58617616        2692331770      70      71
18      80373285        2610810278      70      71
17      83257441        2526363427      70      71
16      90338345        2434734517      70      71
15      101991189       2331286294      70      71
14      107043718       2222713363      70      71
13      114364328       2106715242      70      71
12      133275309       1971535983      70      71
11      135086622       1834519535      70      71
10      133797422       1698810704      70      71
9       138394717       1558438902      70      71
8       145138636       1411226840      70      71
7       159345973       1249604479      70      71
6       170805979       1076358398      70      71
5       181538259       892226719       70      71
4       190214555       699294797       70      71
3       198295559       498166428       70      71
2       242193529       252512975       70      71
1       248956422       16      70
</pre></div>
</div>
</div>
</div>
</div></blockquote>
</div>
<div class="section" id="redireccion">
<h2>Redirección: <code class="code docutils literal notranslate"><span class="pre">|</span></code><a class="headerlink" href="#redireccion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Una de las principales utilidades de la línea de comandos es la posibilidad de concatenar comandos, es decir, tomar el resultado de un comando y pasarselo al siguiente comando</p>
<p>Para ello debemos considerar que cuando ejecutamos un programa o comando, este nos arroja <em>standard streams</em>, dentro de las cuales tenemos dos muy importantes</p>
<div class="toggle admonition">
<p class="admonition-title">STDOUT</p>
<p>La salida estandar (STDOUT) es lo que arroja un comando o un programa a la terminal, contiene unicamente el resultado del proceso que haya realizado un comando o programa</p>
<p>En el siguiente ejemplo, <code class="code docutils literal notranslate"><span class="pre">&quot;Hello</span> <span class="pre">world!&quot;</span></code> es la salida estándar del comando <code class="code docutils literal notranslate"><span class="pre">echo</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">echo</span> <span class="s2">&quot;Hello world!&quot;</span>
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">STDERR</p>
<p>El error estándar (STDERR) es también lo que arroja un comando o un programa a la terminal pero que contiene diagnósticos internos e información del proceso que haya realizado un comando o programa (no necesariamente el resultado)</p>
<p>En el siguiente ejemplo, <code class="code docutils literal notranslate"><span class="pre">&quot;Hola</span> <span class="pre">mundo!&quot;</span></code> es la salida estándar del comando <code class="code docutils literal notranslate"><span class="pre">cat</span></code>, no obstante, al no haber encontrado el archivo <code class="code docutils literal notranslate"><span class="pre">mi_otro_archivo.txt</span></code>, nos manda el mensaje de <em>error</em> (STDERR) <code class="code docutils literal notranslate"><span class="pre">cat:</span> <span class="pre">mi_archivo.txt</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ cat mi_archivo.txt mi_otro_archivo.txt
cat: mi_otro_archivo.txt No such file or directory
Hola mundo!
</pre></div>
</div>
</div>
<p>Teniendo esto en mente, veremos que los pipes “<code class="code docutils literal notranslate"><span class="pre">|</span></code>” toman el <code class="code docutils literal notranslate"><span class="pre">STDOUT</span></code> y lo convierten en otro <em>standard stream</em> llamado entrada estandar (STDIN)</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>De modo natural, nuestros programas y comandos generan <code class="code docutils literal notranslate"><span class="pre">STDOUT</span></code>, los pipes toman este stream y lo pueden pasar a otro comando</p>
<p>Aunque nosotros no vemos el <code class="code docutils literal notranslate"><span class="pre">STDIN</span></code>, el siguiente comando si puede verlo y procesarlo como si se tratara de un archivo</p>
<p>El siguiente comando también generará <code class="code docutils literal notranslate"><span class="pre">STDOUT</span></code> y <code class="code docutils literal notranslate"><span class="pre">STDERR</span></code> y podemos seguir transformando el <code class="code docutils literal notranslate"><span class="pre">STDOUT</span></code> resultante <em>ad infinitum</em> &amp; <em>ad nauseam</em></p>
<p>En teoria podríamos concatenar tantos comandos como queramos, siempre y cuando la construcción tenga sentido</p>
<img alt="_images/stdin_stderr.png" src="_images/stdin_stderr.png" />
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ seq <span class="m">1</span> <span class="m">3</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>

$ seq <span class="m">1</span> <span class="m">3</span> <span class="p">|</span> grep <span class="m">2</span>
<span class="m">2</span>

$ seq <span class="m">1</span> <span class="m">12</span> <span class="p">|</span> grep <span class="m">1</span>
<span class="m">1</span>
<span class="m">10</span>
<span class="m">11</span>
<span class="m">12</span>

$ seq <span class="m">1</span> <span class="m">12</span> <span class="p">|</span> grep <span class="m">1</span> <span class="p">|</span> grep <span class="m">2</span>
<span class="m">12</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>Redirección: <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code> &amp; <code class="code docutils literal notranslate"><span class="pre">&gt;&gt;</span></code><a class="headerlink" href="#id3" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ya vimos como dirigir la salida de nuestros comandos y verla en una terminal, pero ahora. Qué pasa si queremos mandar esos resultados a un archivo?</p>
<p>Para ello usaremos los operadores <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code> &amp; <code class="code docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>El operador <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code> nos permite mandar la salida estándar de un comando o una serie de comandos a un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls

$ seq 1 12 | grep 1 | grep 2
12

$ seq 1 12 | grep 1 | grep 2 &gt; archivo_1

$ ls
archivo_1

$ cat archivo_1
12
</pre></div>
</div>
<div class="admonition danger">
<p class="admonition-title">Peligro</p>
<p>El operador <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code> puede ser muy destructivo si no se emplea adecuadamente:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;blablabla&quot;</span> <span class="o">&gt;</span> <span class="n">tesis_final</span><span class="o">.</span><span class="n">docx</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>El operador <code class="code docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> nos permite <strong>agregar</strong> la salida estándar de un comando o una serie de comandos a un archivo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ seq 1 12 | grep 1 | grep 2 &gt; archivo_1

$ cat archivo_1
12

$ seq 1 12 | grep 1
1
10
11
12

$ seq 1 12 | grep 1 &gt;&gt; archivo_1

$ cat archivo_1
12
1
10
11
12
</pre></div>
</div>
</div>
</div>
<div class="section" id="avanzado-awk">
<h2>Avanzado: <code class="code docutils literal notranslate"><span class="pre">awk</span></code><a class="headerlink" href="#avanzado-awk" title="Enlazar permanentemente con este título">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">awk</span></code> por si mismo es un lenguaje de programación, no obstante tiene aplicación en la línea de comandos como un programa de uso general</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">awk</span></code> sirve para:</dt><dd><ul class="simple">
<li><p>seleccionar columnas</p></li>
<li><p>seleccionar filas</p></li>
<li><p>realizar operaciones aritméticas</p></li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Antes de lanzarnos al uso de <code class="code docutils literal notranslate"><span class="pre">awk</span></code> una pequeña introducción</p>
<ul>
<li><p>awk opera por bloques delimitados con “{}”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ awk &#39;{print $0}&#39;
</pre></div>
</div>
</li>
<li><p>awk puede procesar archivos de forma directa y también puede procesar <code class="code docutils literal notranslate"><span class="pre">STDIN</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ awk &#39;{print $0}&#39; mi_archivo.txt

$ seq 1 12 | awk &#39;{print $1}&#39;
</pre></div>
</div>
</li>
<li><dl>
<dt>Para awk todo puede ser una tabla</dt><dd><ul>
<li><dl class="simple">
<dt>awk puede usar delimitadores de campo tal como lo haria cut</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Las variables FS, IFS &amp; OFS son usadas como delimitadores de campo (field separator)</dt><dd><ul>
<li><p>FS  -&gt; field separator</p></li>
<li><p>IFS -&gt; input field separator</p></li>
<li><p>OFS -&gt; output field separator</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>Los campos para awk son representados con el signo “$”, de modo que el primer campo es “$1”</p></li>
<li><dl class="simple">
<dt>Hay dos campos intrínsecos con notación especial</dt><dd><ul class="simple">
<li><p>NR -&gt; number of rows</p></li>
<li><p>$0 -&gt; all fields</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Tomando en consideración lo anterior, las siguientes construcciones son similares</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ head -n3 archivo_1.csv
a,b,c,d
e,f,g,h
i,j,k,l

$ cut -d, -f1,2 archivo_1.csv | head -n3
a,b
e,f
i,j

$ awk &#39;BEGIN{FS=&quot;,&quot;;OFS=&quot;,&quot;}{print $1 OFS $2}&#39; archivo_1.csv | head -n3
a,b
e,f
i,j
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<dl class="simple">
<dt>Estamos listos para usar awk?</dt><dd><p>Estamos listos para usar awk!</p>
</dd>
</dl>
<p>En la siguiente <a class="reference external" href="https://raw.githubusercontent.com/vflorelo/better_call_ATG/master/docs/source/test_data_variants.tsv">tabla</a> están las variantes encontradas en un experimento de secuenciación de exoma, veamos que le podemos hacer con awk (o con cualquier otro programa)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chr</span><span class="o">.</span>    <span class="n">Position</span>        <span class="n">ID</span>      <span class="n">Ref</span><span class="o">.</span> <span class="n">allele</span>     <span class="n">Alt</span><span class="o">.</span> <span class="n">allele</span>     <span class="n">Genotype</span>        <span class="n">Gene</span>    <span class="n">HGVS</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>        <span class="n">HGVS</span><span class="p">(</span><span class="n">aa</span><span class="p">)</span>        <span class="n">Effect</span>  <span class="n">TOPMED</span>  <span class="n">ExAC</span>    <span class="n">gnomADx</span> <span class="n">gnomADg</span> <span class="mi">1000</span><span class="n">G</span>   <span class="n">PolyPhen</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>     <span class="n">PolyPhen</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>     <span class="n">SIFT</span>    <span class="n">FATHMM</span>  <span class="n">MutAssessor</span>     <span class="n">MutTaster</span>       <span class="n">PROVEAN</span> <span class="n">LRT</span>     <span class="n">MetaSVM</span> <span class="n">MetaLR</span>  <span class="n">FATHMM_MKL</span>      <span class="n">VEST3</span>   <span class="n">REVEL</span>   <span class="n">CADD</span>    <span class="n">DANN</span>    <span class="n">ClinVar</span> <span class="n">InterPro</span>        <span class="n">AF_verdict</span>
<span class="mi">2</span>       <span class="mi">71668784</span>        <span class="n">rs145832952</span>     <span class="n">C</span>       <span class="n">T</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.438596</span><span class="p">)</span> <span class="n">DYSF</span>    <span class="n">c</span><span class="o">.</span><span class="mi">5488</span><span class="n">C</span><span class="o">&gt;</span><span class="n">T</span>       <span class="n">p</span><span class="o">.</span><span class="n">Pro1830Ser</span>    <span class="n">missense_variant</span>        <span class="mf">0.99989</span> <span class="mf">0.00009</span> <span class="mf">0.00012</span> <span class="mf">0.00003</span> <span class="mf">0.00060</span> <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">0</span>       <span class="mi">4</span>       <span class="mi">832</span>     <span class="n">Uncertain_significance</span>  <span class="mi">1</span>       <span class="n">LF</span>
<span class="mi">4</span>       <span class="mi">119150952</span>       <span class="n">rs758181218</span>     <span class="n">C</span>       <span class="n">G</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.441176</span><span class="p">)</span> <span class="n">MYOZ2</span>   <span class="n">c</span><span class="o">.</span><span class="mi">157</span><span class="n">C</span><span class="o">&gt;</span><span class="n">G</span>        <span class="n">p</span><span class="o">.</span><span class="n">Arg53Gly</span>      <span class="n">missense_variant</span>        <span class="mf">0.99999</span> <span class="mf">0.00001</span> <span class="mf">0.00001</span>                 <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">0</span>       <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">432</span>     <span class="n">Uncertain_significance</span>  <span class="mi">0</span>       <span class="n">PLF</span>
<span class="mi">17</span>      <span class="mi">41479481</span>        <span class="n">rs138303882</span>     <span class="n">G</span>       <span class="n">A</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.391304</span><span class="p">)</span> <span class="n">KRT35</span>   <span class="n">c</span><span class="o">.</span><span class="mi">577</span><span class="n">C</span><span class="o">&gt;</span><span class="n">T</span>        <span class="n">p</span><span class="o">.</span><span class="n">Arg193Trp</span>     <span class="n">missense_variant</span>        <span class="mf">0.99811</span> <span class="mf">0.00051</span> <span class="mf">0.00044</span> <span class="mf">0.00162</span> <span class="mf">0.00140</span> <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">0</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">0</span>       <span class="mi">832</span>     <span class="n">none</span>    <span class="mi">0</span>       <span class="n">LF</span>
<span class="mi">1</span>       <span class="mi">232514192</span>       <span class="n">rs770896568</span>     <span class="n">C</span>       <span class="n">A</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.517241</span><span class="p">)</span> <span class="n">SIPA1L2</span> <span class="n">c</span><span class="o">.</span><span class="mi">1148</span><span class="n">G</span><span class="o">&gt;</span><span class="n">T</span>       <span class="n">p</span><span class="o">.</span><span class="n">Ser383Ile</span>     <span class="n">missense_variant</span>        <span class="mf">0.99999</span> <span class="mf">0.00001</span> <span class="mf">0.00000</span> <span class="mf">0.00003</span>         <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">8</span>       <span class="mi">0</span>       <span class="mi">232</span>     <span class="n">none</span>    <span class="mi">0</span>       <span class="n">PLF</span>
<span class="mi">17</span>      <span class="mi">20297028</span>        <span class="n">test_data_novel140</span>      <span class="n">C</span>       <span class="n">A</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.342105</span><span class="p">)</span> <span class="n">SPECC1</span>  <span class="n">c</span><span class="o">.</span><span class="mi">3008</span><span class="n">C</span><span class="o">&gt;</span><span class="n">A</span>       <span class="n">p</span><span class="o">.</span><span class="n">Thr1003Asn</span>    <span class="n">missense_variant</span>        <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">2</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">1</span>       <span class="mi">0</span>       <span class="mi">4</span>       <span class="mi">32</span>      <span class="n">none</span>    <span class="mi">1</span>       <span class="n">LF</span>
<span class="mi">3</span>       <span class="mi">38126203</span>        <span class="n">rs140127056</span>     <span class="n">A</span>       <span class="n">G</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.506329</span><span class="p">)</span> <span class="n">ACAA1</span>   <span class="n">c</span><span class="o">.</span><span class="mi">956</span><span class="n">T</span><span class="o">&gt;</span><span class="n">C</span>        <span class="n">p</span><span class="o">.</span><span class="n">Ile319Thr</span>     <span class="n">missense_variant</span>        <span class="mf">0.99802</span> <span class="mf">0.00055</span> <span class="mf">0.00042</span> <span class="mf">0.00175</span> <span class="mf">0.00240</span> <span class="mi">32</span>      <span class="mi">16</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">0</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">0</span>       <span class="mi">8</span>       <span class="mi">232</span>     <span class="n">none</span>    <span class="mi">2</span>       <span class="n">LF</span>
<span class="mi">1</span>       <span class="mi">119514197</span>       <span class="n">rs774738158</span>     <span class="n">A</span>       <span class="n">G</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>      <span class="n">HSD3B1</span>  <span class="n">c</span><span class="o">.</span><span class="mi">674</span><span class="n">A</span><span class="o">&gt;</span><span class="n">G</span>        <span class="n">p</span><span class="o">.</span><span class="n">Tyr225Cys</span>     <span class="n">missense_variant</span>                <span class="mf">0.00040</span> <span class="mf">0.00013</span> <span class="mf">0.00045</span>         <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">0</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">16</span>      <span class="mi">2</span>       <span class="mi">32</span><span class="n">none</span>  <span class="mi">1</span>       <span class="n">pLF</span>
<span class="mi">1</span>       <span class="mi">152313385</span>       <span class="n">rs61816761</span>      <span class="n">G</span>       <span class="n">A</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.435115</span><span class="p">)</span> <span class="n">FLG</span>     <span class="n">c</span><span class="o">.</span><span class="mi">1501</span><span class="n">C</span><span class="o">&gt;</span><span class="n">T</span>       <span class="n">p</span><span class="o">.</span><span class="n">Arg501</span><span class="o">*</span>       <span class="n">stop_gained</span>     <span class="mf">0.98844</span> <span class="mf">0.00873</span> <span class="mf">0.00937</span> <span class="mf">0.00940</span> <span class="mf">0.00339</span> <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">2</span>       <span class="mi">8</span><span class="n">Pathogenic</span>     <span class="mi">0</span>       <span class="n">PLF</span>
<span class="mi">4</span>       <span class="mi">169713231</span>       <span class="n">rs770732784</span>     <span class="n">A</span>       <span class="n">G</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.323529</span><span class="p">)</span> <span class="n">CLCN3</span>   <span class="n">c</span><span class="o">.</span><span class="mi">2302</span><span class="n">A</span><span class="o">&gt;</span><span class="n">G</span>       <span class="n">p</span><span class="o">.</span><span class="n">Met768Val</span>     <span class="n">missense_variant</span>        <span class="mf">0.99997</span> <span class="mf">0.00008</span> <span class="mf">0.00008</span>                 <span class="mi">4</span>       <span class="mi">2</span>       <span class="mi">16</span>      <span class="mi">16</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">16</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">8</span>       <span class="mi">8</span>       <span class="mi">232</span>     <span class="n">Uncertain_significance</span>  <span class="mi">1</span>       <span class="n">PLF</span>
<span class="mi">19</span>      <span class="mi">9996220</span> <span class="n">rs148417859</span>     <span class="n">G</span>       <span class="n">A</span>       <span class="n">Het</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.436364</span><span class="p">)</span> <span class="n">COL5A3</span>  <span class="n">c</span><span class="o">.</span><span class="mi">1465</span><span class="n">C</span><span class="o">&gt;</span><span class="n">T</span>       <span class="n">p</span><span class="o">.</span><span class="n">Arg489Cys</span>     <span class="n">missense_variant</span>        <span class="mf">0.99959</span> <span class="mf">0.00016</span> <span class="mf">0.00015</span> <span class="mf">0.00019</span>         <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">32</span>      <span class="mi">32</span>      <span class="mi">4</span>       <span class="mi">4</span>       <span class="mi">0</span>       <span class="mi">2</span>       <span class="mi">32</span><span class="n">none</span>  <span class="mi">0</span>       <span class="n">PLF</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Condicionales en <code class="code docutils literal notranslate"><span class="pre">awk</span></code></p>
<p>Con awk podemos emplear condicionales simples que nos permiten obtener segmentos específicos de un archivo o de un stream</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>awk <span class="s1">&#39;BEGIN{FS=&quot;\t&quot;}{if($1==1 &amp;&amp; $2&gt;=1000000 &amp;&amp; $2&lt;=2000000){print $0}}&#39;</span> variant_table.tsv
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Desglosemos esta construcción:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">awk</span> <span class="pre">'BEGIN{FS=&quot;\t&quot;}'</span></code></dt><dd><p>Este segmento inicia el proceso de lectura del archivo (<code class="code docutils literal notranslate"><span class="pre">BEGIN</span></code>) y le indica a awk que el separador de campo es un tabulador “\t”</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">{if($1==1</span> <span class="pre">&amp;&amp;</span> <span class="pre">$2&gt;=1000000</span> <span class="pre">&amp;&amp;</span> <span class="pre">$2&lt;=2000000}</span></code></dt><dd><p>Esta condicional (<code class="code docutils literal notranslate"><span class="pre">if(condition){actions}</span></code>) se lee como:</p>
<ul>
<li><dl class="simple">
<dt>Si se cumplen las siguientes condiciones:</dt><dd><ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">$1=='1'</span></code> la primera columna es igual a 1</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> y además</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">$2&gt;='1000000'</span></code> la segunda columna es mayor o igual a 1,000,000</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> y además</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">$2&lt;='2000000'</span></code> la segunda columna es menor o igual a 2,000,000</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>entonces:</dt><dd><ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">{print</span> <span class="pre">$0}</span></code> muestrame en pantalla todas las columnas</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Y en términos biológicos:</dt><dd><p><strong>Dame todas las variantes del cromosoma 1, del nucleótido 1000000 al nucleótido 2000000</strong></p>
</dd>
</dl>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Es importante diferenciar los signos <code class="code docutils literal notranslate"><span class="pre">=</span></code> &amp; <code class="code docutils literal notranslate"><span class="pre">==</span></code></p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">=</span></code> es un operador de asignación, por lo que no lo podemos usar en condicionales</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">==</span></code> es un operador de comparación, ideal para usarlo en condicionales</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Las condicionales son sumamente útiles en cualquier lenguaje de programación, sin embargo antes de ejecutarlas debemos verificar que tengan sentido:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{if($1==1 &amp;&amp; $2&lt;=1000000 &amp;&amp; $2&gt;=2000000}
</pre></div>
</div>
<dl class="simple">
<dt>Esta construcción no tiene sentido, ya que esencialmente le estaremos pidiendo a awk que nos entregue filas en dónde se cumplen las siguientes condiciones:</dt><dd><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">$1=='1'</span></code> la primera columna sea igual a 1</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> y además</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">$2&lt;='1000000'</span></code> la segunda columna sea menor o igual a 1,000,000</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> y además</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">$2&gt;='2000000'</span></code> la segunda columna sea mayor o igual a 2,000,000</p></li>
</ul>
</dd>
</dl>
</div>
<div class="toggle admonition">
<p class="admonition-title">Reto!</p>
<p>Mandanos por correo los comandos que usarias para:</p>
<blockquote>
<div><ul class="simple">
<li><p>Obtener las variantes que se ubiquen en el gen <em>DMD</em></p></li>
<li><p>Obtener las variantes sinónimas del cromosoma 4</p></li>
<li><p>Obtener las variantes no sinónimas heterocigotas del cromosoma 16</p></li>
<li><p>Obtener las variantes no sinónimas heterocigotas del cromosoma 1 que tengan una frecuencia alélica en el proyecto 1000 Genomas de menos de 0.01</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
</div>
<div class="section" id="ngs">
<h1><a class="reference internal" href="ngs.html"><span class="doc">NGS</span></a><a class="headerlink" href="#ngs" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="id4">
<h2>Introducción<a class="headerlink" href="#id4" title="Enlazar permanentemente con este título">¶</a></h2>
<p>NGS es un término sombrilla que hace referencia a la última generación de tecnologías de secuenciación</p>
<p>Actualmente hay tres generaciones de tecnologías de secuenciación disponibles de forma comercial</p>
<blockquote>
<div><ol class="arabic simple">
<li><dl class="simple">
<dt>Primera generación: secuenciación por terminación didesoxi</dt><dd><ul class="simple">
<li><p>Secuenciación Sanger en geles de acrilamida</p></li>
<li><p>Secuenciación Sanger en capilares</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Segunda generación: secuenciación por síntesis:</dt><dd><ul class="simple">
<li><p>Roche 454</p></li>
<li><p>Illumina</p></li>
<li><p>Applied Biosystems SOLiD</p></li>
<li><p>Ion Torren / Ion Proton</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Tercera generación: secuenciación por lectura directa de moléculas</dt><dd><ul class="simple">
<li><p>PacBio</p></li>
<li><p>Oxford Nanopore</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<a class="reference internal image-reference" href="_images/generations.png"><img alt="_images/generations.png" src="_images/generations.png" style="width: 600px;" /></a>
</div>
<div class="section" id="aspectos-generales-de-la-secuenciacion-masiva">
<h2>Aspectos generales de la secuenciación masiva<a class="headerlink" href="#aspectos-generales-de-la-secuenciacion-masiva" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Si bien las tecnologías de secuenciación son muy diversas, el principio es fundamentalmente el mismo:</p>
<ol class="arabic">
<li><dl class="simple">
<dt>Se obtiene el DNA genómico de la muestra</dt><dd><ul class="simple">
<li><p>El tipo de muestra determina el procedimiento a emplear (kit, consumibles, equipo)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>El DNA genómico es fragmentado de forma semi-aleatoria</dt><dd><ul class="simple">
<li><p>Fragmentación mecánica</p></li>
<li><p>Fragmentación enzimática</p></li>
</ul>
<p>Los kits de secuenciación indican el tamaño de fragmento a obtener, para exoma y genoma éstos van de 300 a 800 bp</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Se ligan adaptadores a ambos lados de los fragmentos generados.</dt><dd><p>En este momento tenemos bibliotecas genómicas y dependiendo de su concentración pueden estar listas para secuenciar</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Se agregan más oligonucleótidos a ambos lados de los fragmentos generados.</dt><dd><ul class="simple">
<li><p>Éste es un paso opcional pero común cuando se procesa más de una muestra por corrida</p></li>
<li><p>En caso de no contar con la cantidad adecuada, se amplifican las bibliotecas mediante una reacción de PCR</p></li>
</ul>
<p>En este momento tenemos bibliotecas uniplex listas para combinarse y tener bibliotecas multiplex</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>La biblioteca multiplex se inmobiliza en una matriz:</dt><dd><ul class="simple">
<li><p>Puede ser una superficie en el caso de Illumina, PacBio &amp; Nanopore</p></li>
<li><p>Puede ser en perlas como en Ion Proton &amp; 454</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>Se secuencian las bibliotecas multiplexeadas en el aparato</dt><dd><ul class="simple">
<li><p>La configuración de la corrida es fundamental para obtener el mejor rendimiento de nuestros reactivos, de nuestra muestra y muy importante, de nuestros datos de secuenciación</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Es recomendable secuenciar por ambos lados las bibliotecas, ya que la información de un solo lado de la lectura (75-300 nt) puede perderse en la inmensidad del genoma (3Gbp en el caso de humano)
Es recomendable secuenciar fragmentos largos medianamente espaciados (2x150 nt + 200) para maximizar el rendimiento de la corrida, esto lo determina el laboratorio de biología molecular, los Field Application Scientists y los kits de secuenciación</p>
</div>
</dd>
</dl>
</li>
</ol>
<a class="reference internal image-reference" href="_images/ngs_commons.png"><img alt="_images/ngs_commons.png" src="_images/ngs_commons.png" style="width: 300px;" /></a>
</div>
<div class="section" id="como-se-obtiene-un-exoma">
<h2>Cómo se obtiene un exoma?<a class="headerlink" href="#como-se-obtiene-un-exoma" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Un exoma usualmente se obtiene mediante captura de regiones específicas a través de sondas que hibridan mediante complementaridad de bases en las regiones correspondientes a los exones del organismo que estemos tratando</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Los kits de captura para exomas humanos constan de cientos de miles de sondas que hibridan específicamente con los exones de los &gt;20000 genes codificados en el genoma humano!</p>
<a class="reference internal image-reference" href="_images/exome.png"><img alt="_images/exome.png" src="_images/exome.png" style="width: 600px;" /></a>
</div>
<p>Existen otras estrategias como la de amplificación, sin embargo éstas tienen un rendimiento considerablemente inferior al de captura, adicionalmente, pueden ser susceptibles de rearreglos (captura también es sensible a rearreglos, pero no se pierden las variantes presentes en las regiones rearregladas)</p>
</div>
<div class="section" id="evolucion-en-los-costos-de-secuenciacion-y-comparacion-de-plataformas">
<h2>Evolución en los costos de secuenciación y comparación de plataformas<a class="headerlink" href="#evolucion-en-los-costos-de-secuenciacion-y-comparacion-de-plataformas" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition-esta-figura-la-hemos-visto-hasta-el-cansancio-pero-que-significa admonition">
<p class="admonition-title">Esta figura la hemos visto hasta el cansancio, pero… qué significa?</p>
<a class="reference internal image-reference" href="_images/genome_cost.jpg"><img alt="_images/genome_cost.jpg" src="_images/genome_cost.jpg" style="width: 600px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>La ley de Moore en realidad es aplicable a poder de cómputo vs costo vs tiempo. No obstante la genómica y la bioinformática van de la mano, de modo que si bien no es directamente aplicable, si podemos extrapolar la ley de Moore con respecto al costo esperado de la secuenciación de genomas.</p>
<p>Esta imagen esencialmente nos indica que ahora es más fácil secuenciar genomas completos, y eso es tambien un aliciente para implementar metodologías de genoma o exoma completos por encima de las opciones de paneles específicos</p>
</div>
</div>
<div class="admonition-y-el-rendimiento admonition">
<p class="admonition-title">Y el rendimiento?</p>
<a class="reference internal image-reference" href="_images/throughput.png"><img alt="_images/throughput.png" src="_images/throughput.png" style="width: 600px;" /></a>
<p>No todas las plataformas entregan el mismo rendimiento, incluso si son baratas, por lo que es importante no solamente elegir el kit adecuado para obtener exomas o paneles específicos. Las distintas plataformas nos van a entregar throughputs diferentes, incluso dentro de la misma plataforma en diferentes versiones, la salida de los secuenciadores puede ser muy muy variada</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>Para secuenciación masiva de genoma y de exoma, actualmente puede usarse Illumina, Ion Proton, PacBio o Nanopore, no obstante Illumina tiene ventajas notables sobre las demás plataformas:</p>
<ul class="simple">
<li><p>No es tan susceptible a errores en regiones homopoliméricas</p></li>
<li><p>Tiene el throughput más alto de todas las tecnologías</p></li>
<li><p>Tiene la relación más alta en costo beneficio en cuanto a costo por base secuenciada</p></li>
<li><p>Tiene mayor número de certificaciones en aplicaciones clínicas y de investigación</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Pese a sus ventajas, Illumina tiene deficiencias a nivel de detección de variaciones estructurales:</p>
<ul class="simple">
<li><p>No permite la detección de rearreglos (la opción es Nanopore y PacBio)</p></li>
<li><p>No permite la detección de expansiones con la resolución adecuada (Nanopore &gt; PacBio &gt; Ion Proton si pueden realizar esta tarea)</p></li>
<li><p>No permite la resolución de regiones repetitivas (Nanopore y PacBio son la mejor opción)</p></li>
</ul>
</div>
<p>Por lo anterior nos concentraremos en la tecnología Illumina para el llamado de variantes</p>
</div>
<div class="section" id="secuenciacion-illumina">
<h2>Secuenciación Illumina<a class="headerlink" href="#secuenciacion-illumina" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Illumina es por mucho la principal plataforma de secuenciación masiva, no obstante las tecnologías de tercera generación pronto competirán con Illumina tanto en la clínica como en la investigación y en otras áreas en donde se apliquen estrategias de secuenciación</p>
<a class="reference internal image-reference" href="_images/popularity.png"><img alt="_images/popularity.png" src="_images/popularity.png" style="width: 600px;" /></a>
</div>
<div class="admonition-cual-es-la-quimica-en-la-secuenciacion-illumina admonition">
<p class="admonition-title">Cúal es la química en la secuenciación Illumina?</p>
<img alt="_images/illumina_seq.png" src="_images/illumina_seq.png" />
<p>En la secuenciación illumina, cada fragmento se lee dos veces (una vez en <em>foward</em> y una más en <em>reverse</em>), en cada incorporación de nucleótidos, se llevan a cabo los siguientes pasos:</p>
<ul class="simple">
<li><p>Se incorpora un nucleótido marcado con un fluoróforo específico</p></li>
<li><p>Se detiene transitoriamente la reacción</p></li>
<li><p>Se excitan los fluoróforos presentes en los nucleótidos incorporados</p></li>
<li><p>Se lee la emisión de luz correspondiente a cada nucleótido</p></li>
<li><p>Las intensidades de cada spot son registradas y transformadas en secuencias de nucleótidos</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>La intensidad de los spots estará intimamente ligada a la capacidad del detector de separar señales ruidosas y en consecuencia de entregarnos secuencias de calidad.</p>
</div>
</div>
</div>
<div class="section" id="calidad-de-la-secuenciacion">
<h2>Calidad de la secuenciación<a class="headerlink" href="#calidad-de-la-secuenciacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El detector de los secuenciadores Illumina es esencialmente una cámara muy grande (muy (seriously, muy)). Cómo hace para discriminar entre una señal ruidosa de una señal real?</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Estas son imagenes reales de reacciones de secuenciación</p>
<a class="reference internal image-reference" href="_images/illumina_signal_to_noise.png"><img alt="_images/illumina_signal_to_noise.png" src="_images/illumina_signal_to_noise.png" style="width: 600px;" /></a>
<p>La calidad de una reacción de secuenciación está en función de la capacidad del aparato de separar el ruido de una señal ruidosa.</p>
</div>
<div class="admonition-un-poco-de-historia-para-entender-la-calidad-de-las-secuencias admonition">
<p class="admonition-title">Un poco de historia para entender la calidad de las secuencias</p>
<img alt="_images/quality.png" src="_images/quality.png" />
<p>Cuando hacemos secuenciación Sanger podemos distinguir facilmente cuando una secuencia es de mala calidad porque los picos se traslapan con la señal basal de la fluorescencia de los demás nucleótidos</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En secuenciación masiva ocurre similar pero lo podemos ver de una forma numérica</p>
<img alt="_images/phred_scores.png" src="_images/phred_scores.png" />
</div>
<p>Incorporemos ahora nuestros Phred scores en una secuenciación tradicional</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/low_qual_chrom.png"><img alt="low qual chrom" src="_images/low_qual_chrom.png" style="height: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/high_qual_chrom.png"><img alt="high qual chrom" src="_images/high_qual_chrom.png" style="height: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Recordemos que en cómputo, cada caracter de un <em>string</em> pesa ~1 byte</p>
<p>Cuando incorporamos los phred scores en un archivo, éste pesará por lo menos el doble si se trata de secuencias de baja calidad, y podría pesar hasta el triple cuando son secuencias de alta calidad</p>
<p>Puedes identificar por qué?</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Esto no parece ser muy problemático, si partimos de lo anterior, una secuencia de 1000 nucleótidos no excederá 1 Kb y con calidades incluidas no excederá 3 Kb</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Pero en secuenciación masiva tenemos millones de secuencias! Entonces el tamaño si importa.</p>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solución al problema de codificar los phred scores en NGS</p>
<p>El código ASCII es una implementación internacional que codifica caracteres alfanuméricos en una estructura controlada, cada letra tiene un identificador único y es valido internacionalmente.</p>
<p>Y esto cómo conecta con la calidad?</p>
<p>Dado que cada caracter (1 byte) tiene un código numérico (llegando incluso a más de 100), podemos codificar números que midan 2 bytes, en caracteres que midan unicamente 1 byte</p>
<a class="reference internal image-reference" href="_images/phred_scale.png"><img alt="_images/phred_scale.png" src="_images/phred_scale.png" style="width: 600px;" /></a>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Sabiendo lo anterior, nuestro cromatograma lo podemos representar de la siguiente manera</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/high_qual_chrom.png"><img alt="high qual chrom" src="_images/high_qual_chrom.png" style="height: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/high_qual_fastq.png"><img alt="high qual fastq" src="_images/high_qual_fastq.png" style="height: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition-y-ahora-en-secuenciacion-masiva admonition">
<p class="admonition-title">Y ahora en secuenciación masiva!</p>
<img alt="_images/fastq_format.png" src="_images/fastq_format.png" />
<p>Considerando que ya conocemos las equivalencias del código ASCII con la escala Phred, qué podrías decir de las secuencias anteriores?</p>
<ul class="simple">
<li><p>Son de buena calidad?</p></li>
<li><p>Son de mala calidad?</p></li>
</ul>
<div class="toggle admonition">
<p class="admonition-title">Solución</p>
<p><strong>Existen distintos *offsets* de la escala Phred!</strong></p>
<p>Es indispensable que consultes con tu centro de secuenciación cual es el <em>offset</em> en la escala Phred de tu reacción de secuenciación!</p>
<img alt="_images/phred_scales.png" src="_images/phred_scales.png" />
</div>
</div>
<div class="admonition-y-entonces-tenemos-fastq admonition">
<p class="admonition-title">Y entonces tenemos fastq!</p>
<p>El formato fastq es sumamente rico, ya que además de la secuencia, tenemos información de la calidad de la secuencia y más, mucho más</p>
<img alt="_images/fastq_header.png" src="_images/fastq_header.png" />
</div>
</div>
<div class="section" id="fastqc">
<h2>FastQC<a class="headerlink" href="#fastqc" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para nosotros poder examinar la calidad de nuestras secuencias, podemos medir directamente sus calidades en formato fastq, y para ello usaremos la aplicación FastQC.</p>
<ul class="simple">
<li><p>Es una aplicación escrita en Java que permite portabilidad, es decir, puede correr en Windows, Linux y OSX</p></li>
<li><p>Cuenta con interfáz gráfica y también en línea de comandos</p></li>
<li><p>Entrega reportes a manera de páginas web</p></li>
</ul>
<p>Sabiendo lo anterior, tomamos nuestra terminal, nos vamos a la carpeta del día 2 y ejecutamos FastQC</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<dl class="simple">
<dt>En la carpeta del día 2, encontrarás archivos de secuenciación correspondientes al proyecto &quot;NextSeq 550: Nextera Flex for Enrichment (12-plex, NA12878) with TruSight One Expanded Panel&quot; Albergado en <a class="reference external" href="https://basespace.illumina.com/datacentral">Basespace</a></dt><dd><p>24 replicates of Coriell NA12878 were prepared using the Nextera Flex for Enrichment with TruSight One Expanded in 12-plex hybridizations with IDT for Illumina- Nextera UD Indexes, sequenced at 2x149 on NextSeq. Analysis was performed using the BaseSpace Enrichment app.</p>
</dd>
</dl>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls
dia_01 dia_02 dia_03

$ cd dia_02

$ ls -lh
total 648M
-rwxrwxr-x 1 vflorelo bioinformatics  81M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R1_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  82M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R2_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  80M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L002_R1_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  81M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L002_R2_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  81M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L003_R1_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  82M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L003_R2_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  80M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L004_R1_001.fastq.gz
-rwxrwxr-x 1 vflorelo bioinformatics  82M Sep 22 06:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L004_R2_001.fastq.gz


$ file NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R1_001.fastq.gz
NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R1_001.fastq.gz: gzip compressed data, was &quot;NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R1_001.fastq&quot;, last modified: Sun Sep 20 21:12:05 2020, max compression, from Unix


$ fastqc *.gz
</pre></div>
</div>
</div>
</div>
<div class="section" id="burrows-wheeler-transform">
<h1><a class="reference internal" href="bwa.html"><span class="doc">Burrows Wheeler Transform</span></a><a class="headerlink" href="#burrows-wheeler-transform" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="before-we-start">
<h2><em>Before we start</em><a class="headerlink" href="#before-we-start" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La sesión del día de hoy implica correr un par de comandos que tomarán algo de tiempo, en consecuencia, los correremos al inicio de la sesión y explicaremos su sintaxis y funcionamiento a lo largo de la sesión.</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>En los ambientes unix linux los programas no se instalan de la misma forma que en los ambientes windows o mac, en vez tenemos que descargar el código fuente de los programas, compilarlo cuando así sea necesario e instalarlo en algun lugar de nuestro sistema</p>
<p>Los siguientes comandos nos permitirán instalar bwa en nuestro sistema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ git clone https://github.com/lh3/bwa.git

$ls
bwa dia_01 dia_02 dia_03

$ mkdir bin

$ cd bwa

$ make

$ mv bwa /home/vflorelo/bin

$ bwa index
</pre></div>
</div>
</div>
<div class="admonition-comandos-del-dia admonition">
<p class="admonition-title">Comandos del día</p>
<p>Recuerda copiar unicamente los comandos en las líneas marcadas con el signo “$”</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ls
/home/vflorelo

$ ls
dia_01
dia_02
dia_03

$ <span class="nb">cd</span> dia_02

$ ls -lh

total 648M
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  81M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R1_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  82M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L001_R2_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  80M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L002_R1_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  81M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L002_R2_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  81M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L003_R1_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  82M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L003_R2_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  80M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L004_R1_001.fastq.gz
-rwxrwxr-x <span class="m">1</span> vflorelo bioinformatics  82M Sep <span class="m">22</span> <span class="m">06</span>:19 NA12878-TS1Exp-TiVAL3-rep5_S20_L004_R2_001.fastq.gz


$ cat <span class="se">\*</span>R1_001.fastq.gz &gt; ../dia_03/forward_reads.fastq.gz

$ cat <span class="se">\*</span>R2_001.fastq.gz &gt; ../dia_03/reverse_reads.fastq.gz

$ <span class="nb">cd</span> ../dia_03

$ bwa mem -M -t <span class="m">4</span> /usr/local/bioinformatics/databases/genome/Homo_sapiens_GRCh38.fasta forward_reads.fastq.gz reverse_reads.fastq.gz &gt; S1.sam <span class="p">&amp;</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Es importante que antes de dar enter al último comando nos muestren sus pantallas para que podamos seguir, este último comando generará un archivo de ~15 Gb en ~1 h</p>
</div>
</div>
<div class="section" id="id5">
<h2>Introducción<a class="headerlink" href="#id5" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ya tenemos nuestras secuencias en formato fastq y salieron bien de calidad. Qué hago con las secuencias para el llamado de variantes?</p>
<p>El siguiente paso es alinear dichas lecturas sobre un genoma de referencia que nos permita detectar variaciones <strong>con respecto de ese genoma</strong></p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>En llamado de variantes es de suma importancia especificar cual fue la referencia que se empleó</p>
<p>La secuencia de referencia del genoma humano no es la misma en 2020 que la que se liberó en Mayo de 2000, en total ha sufrido 19 revisiones para un total de 20 versiones.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>“The human reference genome GRCh38 was released from the Genome Reference Consortium on 17 December 2013. This build contained around 250 gaps, whereas the first version had roughly 150,000 gaps”</p>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>En este taller emplearemos la versión GRCh38 (hg38) del genoma humano.</p>
</div>
</div>
<div class="section" id="alineamiento-de-lecturas-sobre-un-genoma">
<h2>Alineamiento de lecturas sobre un genoma<a class="headerlink" href="#alineamiento-de-lecturas-sobre-un-genoma" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Existen cientos de estrategias con las que se pueden alinear secuencias sobre un genoma de referencia, no obstante muchas de ellas son imprácticas cuando se trata de datos voluminosos</p>
<p>En esta sesión veremos una de las estrategias más ampliamente utilizadas en bioinformática (no solamente en llamado de variantes): Alineamiento basado en la transformada de Burrows-Wheeler</p>
<p>Este procedimiento consta de dos etapas</p>
<ol class="arabic simple">
<li><p>Construcción de la transformada de Burrows-Wheeler de nuestra secuencia genómica</p></li>
<li><p>Busqueda de las posiciones de las lecturas sobre la secuencia genómica mediante backtracking</p></li>
</ol>
</div>
<div class="section" id="transformada-de-burrows-wheeler">
<h2>Transformada de Burrows-Wheeler<a class="headerlink" href="#transformada-de-burrows-wheeler" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>La transformada de Burrows-Wheeler (BWT por sus siglas en inglés) tiene aplicaciones en múltiples áreas, es el fundamento de algoritmos de compresión como el protocolo gz</p>
<p>La BWT consta de 4 pasos esenciales</p>
<ol class="arabic simple">
<li><p>Construcción de una matriz de permutaciones</p></li>
<li><p>Ordenamiento lexicográfico de la matriz</p></li>
<li><p>Extracción de los campos informativos</p></li>
<li><p>Compresión de los datos para su manejo</p></li>
</ol>
</div>
<p>Comencemos con un ejemplo <em>sencillo</em> (<em>ish</em>): tomemos la palabra <code class="code docutils literal notranslate"><span class="pre">MISSISSIPPI</span></code></p>
<div class="admonition-construccion-de-una-matriz-de-permutaciones admonition">
<p class="admonition-title">Construcción de una matriz de permutaciones</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/bwt_01.png"><img alt="command" src="_images/bwt_01.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_02.png"><img alt="command" src="_images/bwt_02.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_03.png"><img alt="command" src="_images/bwt_03.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_04.png"><img alt="command" src="_images/bwt_04.png" style="width: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/bwt_05.png"><img alt="command" src="_images/bwt_05.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_06.png"><img alt="command" src="_images/bwt_06.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_07.png"><img alt="command" src="_images/bwt_07.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_08.png"><img alt="command" src="_images/bwt_08.png" style="width: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/bwt_09.png"><img alt="command" src="_images/bwt_09.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_10.png"><img alt="command" src="_images/bwt_10.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_11.png"><img alt="command" src="_images/bwt_11.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/bwt_12.png"><img alt="command" src="_images/bwt_12.png" style="width: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition-ordenamiento-lexicografico-de-la-matriz-y-obtencion-de-los-campos-informativos admonition">
<p class="admonition-title">Ordenamiento lexicográfico de la matriz y obtención de los campos informativos</p>
<a class="reference internal image-reference" href="_images/bwt_13.png"><img alt="_images/bwt_13.png" src="_images/bwt_13.png" style="width: 600px;" /></a>
</div>
<div class="admonition-compresion-de-los-datos admonition">
<p class="admonition-title">Compresión de los datos</p>
<p><code class="code docutils literal notranslate"><span class="pre">MISSISSIPPI</span> <span class="pre">-&gt;</span> <span class="pre">IPSSM#PISSII</span> <span class="pre">-&gt;</span> <span class="pre">IP2SM#PI2S2I</span></code></p>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Este mismo procedimiento se aplica sobre la secuencia genómica a emplear, en el caso del genoma humano estaremos comprimiendo 25 palabras que suman &gt;3,000,000,000 caracteres</p>
</div>
</div>
<div class="section" id="tries-y-busqueda-por-backtracking">
<h2><em>Tries</em> y búsqueda por <em>backtracking</em><a class="headerlink" href="#tries-y-busqueda-por-backtracking" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition-backtracking admonition">
<p class="admonition-title">Backtracking</p>
<p>Una vez que construimos nuestra BWT, podemos buscar palabras sobre dicha BWT, para ello usamos una estrategia de <em>backtracking</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/backtrack_01.png"><img alt="backtrack_01" src="_images/backtrack_01.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/backtrack_04.png"><img alt="backtrack_04" src="_images/backtrack_04.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/backtrack_06.png"><img alt="backtrack_06" src="_images/backtrack_06.png" style="width: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition-busquemos-la-palabra-inicial admonition">
<p class="admonition-title">Busquemos la palabra inicial</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/mississippi_01.png"><img alt="mississippi_01" src="_images/mississippi_01.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/mississippi_02.png"><img alt="mississippi_02" src="_images/mississippi_02.png" style="width: 150px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/mississippi_03.png"><img alt="mississippi_03" src="_images/mississippi_03.png" style="width: 150px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition-ahora-busquemos-solo-la-palabra-miss admonition">
<p class="admonition-title">Ahora busquemos sólo la palabra MISS</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p><a class="reference internal" href="_images/search_01.png"><img alt="search_01" src="_images/search_01.png" style="width: 200px;" /></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="_images/search_02.png"><img alt="search_02" src="_images/search_02.png" style="width: 200px;" /></a></p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Cómo podemos optimizar estas búsquedas?</p>
<p>Para completar la estrategia de búsqueda los programas de mapeo de lecturas usan una estructura de datos llamada árbol de sufijos (<em>suffix tree</em>). Los árboles de sufijos son un tipo especial de <em>otra</em> estructura de datos llamada <em>trie</em> (del inglés <strong>retrieval</strong>).</p>
<a class="reference internal image-reference" href="_images/trie.png"><img alt="_images/trie.png" src="_images/trie.png" style="width: 600px;" /></a>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Esto ocurre en nuestro programa miles de millones de veces de forma paralela! Esta combinación de algoritmos revolucionó el alineamiento de lecturas cortas</p>
</div>
</div>
<div class="section" id="formatos-de-salida-sam">
<h2>Formatos de salida: SAM<a class="headerlink" href="#formatos-de-salida-sam" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Una vez que concluye el proceso de mapeo de lecturas, los programas usualmente entregan un archivo en formato SAM (<em>sequence alignment and mapping</em>)</p>
<p>Este formato es un estándar en bioinformática y la descripción completa del formato, podemos revisar la <a class="reference external" href="http://samtools.github.io/hts-specs/SAMv1.pdf">documentación oficial</a></p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Para fines de este curso, conoceremos la estructura mínima necesaria de dicho formato:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Campo</p></th>
<th class="head" rowspan="2"><p>Descripción</p></th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1</p></td>
<td rowspan="2"><p>Nombre de la lectura</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2</p></td>
<td rowspan="2"><p>FLAG</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>3</p></td>
<td rowspan="2"><p>Nombre de la secuencia de referencia (genoma)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>4</p></td>
<td rowspan="2"><p>Posición de la lectura en dicho genoma</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>5</p></td>
<td rowspan="2"><p>Calidad del mapeo</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>6</p></td>
<td rowspan="2"><p>CIGAR</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>7</p></td>
<td rowspan="2"><p>Nombre de la lectura complementaria (su <em>mate</em>)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>8</p></td>
<td rowspan="2"><p>Posición de la lectura complementaria</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>9</p></td>
<td rowspan="2"><p>Longitud del segmento cubierto por el par</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>10</p></td>
<td rowspan="2"><p>Secuencia de la lectura</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>11</p></td>
<td rowspan="2"><p>Calidad de la lectura (ASCII)</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Ejemplo de un archivo SAM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">1</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">248956422</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">2</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">242193529</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">3</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">198295559</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">4</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">190214555</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">5</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">181538259</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">6</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">170805979</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">7</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">159345973</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">8</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">145138636</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">9</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">138394717</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">10</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">133797422</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">11</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">135086622</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">12</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">133275309</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">13</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">114364328</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">14</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">107043718</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">15</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">101991189</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">16</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">90338345</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">17</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">83257441</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">18</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">80373285</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">19</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">58617616</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">20</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">64444167</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">21</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">46709983</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="mi">22</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">50818468</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="n">X</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">156040895</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="n">Y</span>    <span class="n">LN</span><span class="p">:</span><span class="mi">57227415</span>
<span class="nd">@SQ</span>     <span class="n">SN</span><span class="p">:</span><span class="n">MT</span>   <span class="n">LN</span><span class="p">:</span><span class="mi">16569</span>
<span class="nd">@RG</span>     <span class="n">ID</span><span class="p">:</span><span class="n">test_data</span>    <span class="n">LB</span><span class="p">:</span><span class="n">test_data</span>    <span class="n">PL</span><span class="p">:</span><span class="n">Illumina</span>     <span class="n">SM</span><span class="p">:</span><span class="n">test_data</span>    <span class="n">PU</span><span class="p">:</span><span class="n">test_data</span>
<span class="nd">@PG</span>     <span class="n">ID</span><span class="p">:</span><span class="n">bwa</span>  <span class="n">PN</span><span class="p">:</span><span class="n">bwa</span>  <span class="n">VN</span><span class="p">:</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">17</span><span class="o">-</span><span class="n">r1194</span><span class="o">-</span><span class="n">dirty</span>   <span class="n">CL</span><span class="p">:</span><span class="n">bwa</span> <span class="n">mem</span> <span class="o">-</span><span class="n">M</span> <span class="o">-</span><span class="n">t</span> <span class="mi">4</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> <span class="n">forward_reads</span><span class="o">.</span><span class="n">fastq</span><span class="o">.</span><span class="n">gz</span> <span class="n">reverse_reads</span><span class="o">.</span><span class="n">fastq</span><span class="o">.</span><span class="n">gz</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">11107</span><span class="p">:</span><span class="mi">22080</span><span class="p">:</span><span class="mi">13075</span>       <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12153</span>   <span class="mi">199</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHIJHHHFKDJH</span><span class="o">/</span><span class="n">GIHHE5HG2IH6JFIHHHFJHFIDJHFIDGDGG</span><span class="o">/</span><span class="n">FJDKHFIFIHCIIGGEJH</span><span class="o">/</span><span class="n">FCIFI3</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">21103</span><span class="p">:</span><span class="mi">3654</span><span class="p">:</span><span class="mi">10675</span>        <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12257</span>   <span class="mi">303</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHIJHHHFKDJHDGIHHEJHGFIHFJ</span><span class="o">.</span><span class="n">IHACFJHFIDJHFI5GGGG</span><span class="o">/</span><span class="n">FJDKHFIFIHGIFGGEJ6G7CIFIB</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">21310</span><span class="p">:</span><span class="mi">18749</span><span class="p">:</span><span class="mi">17844</span>       <span class="mi">99</span>      <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12289</span>   <span class="mi">333</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">AFIFHJHGFFKDJHGHIIHEJHGFIHGJ</span><span class="o">/</span><span class="n">JHGHGJGFIDKHGIEGGHGHFKDKHFIFIHFJFGHEKHGFDIFIC</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">72</span><span class="n">M2S</span>      <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">23202</span><span class="p">:</span><span class="mi">12800</span><span class="p">:</span><span class="mi">17985</span>       <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12199</span>   <span class="mi">244</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHIJHHHFKDJHGGIHHEJHGFIHFJFIHHHFJHFIDJHFIDGDGGHFJDKHFIF5HGIIGCEJHG7CIFIC</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">73</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">11205</span><span class="p">:</span><span class="mi">4868</span><span class="p">:</span><span class="mi">3501</span> <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12224</span>   <span class="mi">269</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHIJ7HHFKDJHGAIH2EJHGFIHEJFIHHHFJHFIDJHFI</span><span class="nd">@GGGGHFJDKHFIFIHGIIGGEJFGFBIFI</span><span class="o">/</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">73</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">12201</span><span class="p">:</span><span class="mi">8069</span><span class="p">:</span><span class="mi">10334</span>        <span class="mi">99</span>      <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12262</span>   <span class="mi">308</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">AFIFHJHDFFGDJ12BI5HEJHGFIHGJ</span><span class="o">/</span><span class="n">JHGDGJ3</span><span class="o">/</span><span class="n">CDKHGCEGECGDE</span><span class="o">&gt;</span><span class="mi">26</span><span class="n">H</span><span class="o">/</span><span class="n">IFIHFJHGHEKHG7DIFIC</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">13110</span><span class="p">:</span><span class="mi">9149</span><span class="p">:</span><span class="mi">6398</span> <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12202</span>   <span class="mi">248</span>     <span class="n">CTGCTGGCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHIJHHHFKDJHGGIHHEJHGFIHFJFIHHHFJHFIDJHFIDGGGGHFJDKHFIFIHGIIGGEJHGFCIFIC</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">13403</span><span class="p">:</span><span class="mi">15882</span><span class="p">:</span><span class="mi">14640</span>       <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12244</span>   <span class="mi">289</span>     <span class="n">CTGCTGGCCTGTGCAAGTGTGCAACCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGATCCATGACTAGAGT</span>      <span class="mi">6</span><span class="n">GJ</span><span class="o">/</span><span class="mi">76</span><span class="n">HE0F5DJ</span><span class="o">-</span><span class="p">,</span><span class="o">-</span><span class="mi">51</span><span class="n">JEJA</span><span class="p">,</span><span class="o">--/</span><span class="mi">6</span><span class="n">G</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">HH</span><span class="p">:</span><span class="n">J2AI152</span><span class="o">.</span><span class="mi">51</span><span class="n">D1GGH651K2F5F5F</span><span class="o">./</span><span class="mi">0</span><span class="n">G</span><span class="p">,</span><span class="n">EI</span><span class="o">.</span><span class="n">A7B6</span><span class="o">/</span><span class="mi">6</span><span class="n">C</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">73</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">14</span><span class="n">C2G6G35G5C7</span>      <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">5</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">49</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">49</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">21506</span><span class="p">:</span><span class="mi">17407</span><span class="p">:</span><span class="mi">15401</span>       <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12028</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12137</span>   <span class="mi">182</span>     <span class="n">CTGCTGCCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGT</span>      <span class="n">BGJHI6</span><span class="o">-</span><span class="n">GCFGDGHDG5E2EJHGFID6JABH</span><span class="p">,</span><span class="o">-</span><span class="n">E5HFIDJ2AID1G5FHDHDK</span><span class="p">;</span><span class="n">FIFCF</span><span class="nd">@IA</span><span class="o">/</span><span class="n">G</span><span class="o">/</span><span class="mi">5</span><span class="n">BGFB6FIC</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">73</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">6</span><span class="n">G67</span>       <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">1</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">69</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">69</span>
<span class="n">NB502037</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">HV7GWBGXC</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">13110</span><span class="p">:</span><span class="mi">7444</span><span class="p">:</span><span class="mi">7717</span> <span class="mi">163</span>     <span class="mi">1</span>       <span class="mi">12034</span>   <span class="mi">0</span>       <span class="mi">74</span><span class="n">M</span>     <span class="o">=</span>       <span class="mi">12095</span>   <span class="mi">135</span>     <span class="n">GCCTGTGCCAGGGTGCAAGCTGAGCACTGGAGTGGAGTTTTCCTGTGGAGAGGAGCCATGCCTAGAGTGGGATG</span>      <span class="n">BFFIKDHEHB52HD5HGFIIF9FIH</span><span class="p">,</span><span class="n">HFGHFJ1GEFI1GGGCCFGDJHGIFIIFIHGGDKH</span><span class="o">/</span><span class="n">F</span><span class="p">(</span><span class="mi">5</span><span class="n">CI1H3GFD3</span>      <span class="n">MC</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span><span class="n">M</span>        <span class="n">MD</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="mi">74</span> <span class="n">PG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">MarkDuplicates</span>     <span class="n">RG</span><span class="p">:</span><span class="n">Z</span><span class="p">:</span><span class="n">NGS023</span>     <span class="n">NM</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span>  <span class="n">AS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span> <span class="n">XS</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="mi">74</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="flag">
<h2>FLAG<a class="headerlink" href="#flag" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El FLAG es un estándar dentro de la especificación del formato SAM que nos brinda información estructural acerca de la lectura y como mapea sobre la referencia</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Los códigos de los FLAGs tienen una base binaria, de modo que los códigos son únicos, y cada combinación de bytes indica una situación específica para la lectura correspondiente</p>
<p>Los códigos del FLAG pueden ser consultados en la página del <a class="reference external" href="https://broadinstitute.github.io/picard/explain-flags.html">Broad Institute</a></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Byte</p></th>
<th class="head" rowspan="2"><p>Significado</p></th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1</p></td>
<td rowspan="2"><p>read paired</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2</p></td>
<td rowspan="2"><p>read mapped in proper pair</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>4</p></td>
<td rowspan="2"><p>read unmapped</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>8</p></td>
<td rowspan="2"><p>mate unmapped</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>16</p></td>
<td rowspan="2"><p>read reverse strand</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>32</p></td>
<td rowspan="2"><p>mate reverse strand</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>64</p></td>
<td rowspan="2"><p>first in pair</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>128</p></td>
<td rowspan="2"><p>second in pair</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>256</p></td>
<td rowspan="2"><p>not primary alignment</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>512</p></td>
<td rowspan="2"><p>read fails platform/vendor quality checks</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>1024</p></td>
<td rowspan="2"><p>read is PCR or optical duplicate</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2048</p></td>
<td rowspan="2"><p>supplementary alignment</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="admonition-ejemplos-de-flags admonition">
<p class="admonition-title">Ejemplos de FLAGs</p>
<img alt="_images/flags.png" src="_images/flags.png" />
</div>
</div>
<div class="section" id="concise-idiosyncratic-gapped-alignment-report-cigar-para-los-amigos">
<h2>Concise Idiosyncratic Gapped Alignment Report (CIGAR para los amigos)<a class="headerlink" href="#concise-idiosyncratic-gapped-alignment-report-cigar-para-los-amigos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cómo su nombre lo indica, es un reporte conciso acerca de cómo una lectura alinea con respecto de una secuencia de referencia</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Clave</p></th>
<th class="head" rowspan="2"><p>Significado</p></th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>M</p></td>
<td rowspan="2"><p>Número de matches</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>I</p></td>
<td rowspan="2"><p>Inserciones con respecto a la referencia</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>D</p></td>
<td rowspan="2"><p>Deleciones con respecto a la referencia</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>N</p></td>
<td rowspan="2"><p>Región saltada con respecto a la referencia</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>S</p></td>
<td rowspan="2"><p>Soft clipping*</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>H</p></td>
<td rowspan="2"><p>Hard clipping**</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>P</p></td>
<td rowspan="2"><p>Padding (sólo ensambles de novo)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>=</p></td>
<td rowspan="2"><p>Match completo</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>X</p></td>
<td rowspan="2"><p>Mismatch completo</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
<div class="admonition-ejemplo-de-cigars admonition">
<p class="admonition-title">Ejemplo de CIGARs</p>
<img alt="_images/cigar.png" src="_images/cigar.png" />
</div>
<div class="admonition-campos-adicionales-agregados-por-bwa admonition">
<p class="admonition-title">Campos adicionales agregados por BWA</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 94%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Tag</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NM</p></td>
<td><p>Edit distance</p></td>
</tr>
<tr class="row-odd"><td><p>MD</p></td>
<td><p>Mismatching positions/bases</p></td>
</tr>
<tr class="row-even"><td><p>AS</p></td>
<td><p>Alignment score</p></td>
</tr>
<tr class="row-odd"><td><p>BC</p></td>
<td><p>Barcode sequence</p></td>
</tr>
<tr class="row-even"><td><p>X0</p></td>
<td><p>Number of best hits</p></td>
</tr>
<tr class="row-odd"><td><p>X1</p></td>
<td><p>Number of suboptimal hits found by BWA</p></td>
</tr>
<tr class="row-even"><td><p>XN</p></td>
<td><p>Number of ambiguous bases in the referenece</p></td>
</tr>
<tr class="row-odd"><td><p>XM</p></td>
<td><p>Number of mismatches in the alignment</p></td>
</tr>
<tr class="row-even"><td><p>XO</p></td>
<td><p>Number of gap opens</p></td>
</tr>
<tr class="row-odd"><td><p>XG</p></td>
<td><p>Number of gap extentions</p></td>
</tr>
<tr class="row-even"><td><p>XT</p></td>
<td><p>Type: Unique/Repeat/N/Mate-sw</p></td>
</tr>
<tr class="row-odd"><td><p>XA</p></td>
<td><p>Alternative hits; format: (chr,pos,CIGAR,NM;)*</p></td>
</tr>
<tr class="row-even"><td><p>XS</p></td>
<td><p>Suboptimal alignment score</p></td>
</tr>
<tr class="row-odd"><td><p>XF</p></td>
<td><p>Support from forward/reverse alignment</p></td>
</tr>
<tr class="row-even"><td><p>XE</p></td>
<td><p>Number of supporting seeds</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="manejo-de-archivos-sam-bam-bed-vcf">
<h1><a class="reference internal" href="gatk.html"><span class="doc">Manejo de archivos SAM/BAM/BED/VCF</span></a><a class="headerlink" href="#manejo-de-archivos-sam-bam-bed-vcf" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="id6">
<h2><em>Before we start</em><a class="headerlink" href="#id6" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En los ambientes unix linux los programas no se instalan de la misma forma que en los ambientes windows o mac, en vez tenemos que descargar el código fuente de los programas, compilarlo cuando así sea necesario e instalarlo en algun lugar de nuestro sistema</p>
<p>Los siguientes comandos nos permitirán instalar htslib, samtools y gatk en nuestra carpeta <code class="code docutils literal notranslate"><span class="pre">$HOME/bin</span></code></p>
</div>
<div class="toggle admonition">
<p class="admonition-title">htslib</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ git clone https://github.com/samtools/htslib.git

$ cd /home/vflorelo/htslib

$ autoheader

$ autoconf

$ ./configure --prefix=/home/vflorelo

$ make

$ make install

$ cd /home/vflorelo
</pre></div>
</div>
</div></blockquote>
</div>
<div class="toggle admonition">
<p class="admonition-title">samtools</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ git clone https://github.com/samtools/samtools.git

$ cd /home/vflorelo/samtools

$ autoheader

$ autoconf

$ ./configure --prefix=/home/vflorelo

$ make

$ make install

$ cd /home/vflorelo
</pre></div>
</div>
</div></blockquote>
</div>
<div class="toggle admonition">
<p class="admonition-title">GATK4</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ wget https://github.com/broadinstitute/gatk/releases/download/4.1.8.1/gatk-4.1.8.1.zip

$ unzip gatk-4.1.8.1.zip

$ cd /home/vflorelo/gatk-4.1.8.1

$ mv * /home/vflorelo/bin

$ cd /home/vflorelo

$ chmod -R 775 /home/vflorelo/bin
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="comandos-del-dia-4">
<h2>Comandos del día 4<a class="headerlink" href="#comandos-del-dia-4" title="Enlazar permanentemente con este título">¶</a></h2>
<ol class="arabic" start="0">
<li><p>Preparamos el escenario, abramos nuestra terminal, nos vamos a la carpeta del día 4 y ponemos en ella el archivo en formato SAM que generamos el día 3, adicionalmente tendremos que copiar el archivo <code class="code docutils literal notranslate"><span class="pre">TruSight_One_xt_GRCh38.bed</span></code> que vive en la carpeta <code class="code docutils literal notranslate"><span class="pre">/usr/local/bioinformatics/databases</span></code></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/vflorelo

$ mkdir dia_04

$ ls
dia_01 dia_02 dia_03 dia_04

$ mv dia_03/S1.sam dia_04/

$ cp /usr/local/bioinformatics/databases/TruSight_One_xt_GRCh38.bed dia_04/

$ cd dia_04

$ ls
S1.sam TruSight_One_xt_GRCh38.bed
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Primer paso: transformar nuestro archivo SAM a formato BAM, esencialmente son la misma cosa pero los archivos BAM están comprimidos y en binario</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samtools</span> <span class="n">view</span> \
        <span class="o">-@</span> <span class="mi">4</span> \
        <span class="o">-</span><span class="n">b</span> \
        <span class="o">-</span><span class="n">h</span> \
        <span class="o">-</span><span class="n">o</span> <span class="n">S1</span><span class="o">.</span><span class="n">tmp</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">-</span><span class="n">f</span> <span class="mi">3</span> \
        <span class="o">-</span><span class="n">L</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> <span class="n">S1</span><span class="o">.</span><span class="n">sam</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Si todo sale bien, podemos eliminar nuestro archivo SAM para ahorrarnos espacio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="n">S1</span><span class="o">.</span><span class="n">sam</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Posteriormente agregaremos un <a class="reference external" href="https://www.biostars.org/p/43897/">readgroup</a> a nuestro archivo BAM para indicarle</p></li>
</ol>
<ul>
<li><p>El identificador del <em>readgroup</em></p></li>
<li><p>El nombre de la biblioteca</p></li>
<li><p>La plataforma de secuenciación</p></li>
<li><p>El nombre de la muestra</p></li>
<li><p>La unidad de la plataforma (barcodes)</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">AddOrReplaceReadGroups</span> <span class="o">--</span><span class="n">INPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">tmp</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">OUTPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">rg</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">RGLB</span> <span class="n">S1</span> <span class="o">--</span><span class="n">RGID</span> <span class="n">S1</span> <span class="o">--</span><span class="n">RGPL</span> <span class="n">Illumina</span> <span class="o">--</span><span class="n">RGSM</span> <span class="n">S1</span> <span class="o">--</span><span class="n">RGPU</span> <span class="n">S1</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<ol class="arabic" start="3">
<li><p>Hecho esto, ordenamos con base en las posiciones genómicas nuestro archivo BAM</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">SortSam</span> <span class="o">--</span><span class="n">INPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">rg</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">OUTPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">SORT_ORDER</span> <span class="n">coordinate</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Paso importante (ó no). Marcado de duplicados</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">MarkDuplicates</span> <span class="o">--</span><span class="n">INPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">OUTPUT</span> <span class="n">S1</span><span class="o">.</span><span class="n">dupmarked</span><span class="o">.</span><span class="n">bam</span> <span class="o">--</span><span class="n">METRICS_FILE</span> <span class="n">S1</span><span class="o">.</span><span class="n">dupmarked</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Recalibración de los scores de calidad</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">BaseRecalibrator</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1</span><span class="o">.</span><span class="n">dupmarked</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">known</span><span class="o">-</span><span class="n">sites</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">dbsnp_146</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">known</span><span class="o">-</span><span class="n">sites</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">Mills_and_1000G_gold_standard</span><span class="o">.</span><span class="n">indels</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">table</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Obtención de lecturas recalibradas</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">ApplyBQSR</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1</span><span class="o">.</span><span class="n">dupmarked</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">bqsr</span><span class="o">-</span><span class="n">recal</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">table</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Obtención de scores de calidad de las lecturas recalibradas</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">BaseRecalibrator</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">known</span><span class="o">-</span><span class="n">sites</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">dbsnp_146</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">known</span><span class="o">-</span><span class="n">sites</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">Mills_and_1000G_gold_standard</span><span class="o">.</span><span class="n">indels</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_post</span><span class="o">-</span><span class="n">recal</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">table</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Comparación de los scores de calidad</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">AnalyzeCovariates</span> \
        <span class="o">--</span><span class="n">before</span><span class="o">-</span><span class="n">report</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">table</span> \
        <span class="o">--</span><span class="n">after</span><span class="o">-</span><span class="n">report</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_post</span><span class="o">-</span><span class="n">recal</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">table</span> \
        <span class="o">--</span><span class="n">plots</span><span class="o">-</span><span class="n">report</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">plots</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="comandos-del-dia-5">
<h2>Comandos del día 5<a class="headerlink" href="#comandos-del-dia-5" title="Enlazar permanentemente con este título">¶</a></h2>
<ol class="arabic" start="9">
<li><p>Llamado de variantes <strong>crudas</strong></p>
<blockquote>
<div><p>9.1 Llamado de variantes de línea germinal por individuo en modo <em>single-sample</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">HaplotypeCaller</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">stand</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">conf</span> <span class="mf">10.0</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">vcf</span>        \
        <span class="o">--</span><span class="n">native</span><span class="o">-</span><span class="n">pair</span><span class="o">-</span><span class="n">hmm</span><span class="o">-</span><span class="n">threads</span> <span class="mi">4</span>
</pre></div>
</div>
</div></blockquote>
<p>9.2 Llamado de variantes de línea germinal por individuo para joint-genotype</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">HaplotypeCaller</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">stand</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">conf</span> <span class="mf">10.0</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">native</span><span class="o">-</span><span class="n">pair</span><span class="o">-</span><span class="n">hmm</span><span class="o">-</span><span class="n">threads</span> <span class="mi">4</span> \
        <span class="o">--</span><span class="n">emit</span><span class="o">-</span><span class="n">ref</span><span class="o">-</span><span class="n">confidence</span> <span class="n">GVCF</span> \
        <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">mode</span> <span class="n">EMIT_ALL_CONFIDENT_SITES</span>

<span class="n">gatk</span> <span class="n">HaplotypeCaller</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S2_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">stand</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">conf</span> <span class="mf">10.0</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S2_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">native</span><span class="o">-</span><span class="n">pair</span><span class="o">-</span><span class="n">hmm</span><span class="o">-</span><span class="n">threads</span> <span class="mi">4</span> \
        <span class="o">--</span><span class="n">emit</span><span class="o">-</span><span class="n">ref</span><span class="o">-</span><span class="n">confidence</span> <span class="n">GVCF</span> \
        <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">mode</span> <span class="n">EMIT_ALL_CONFIDENT_SITES</span>

<span class="n">gatk</span> <span class="n">HaplotypeCaller</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S3_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">stand</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">conf</span> <span class="mf">10.0</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S3_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">native</span><span class="o">-</span><span class="n">pair</span><span class="o">-</span><span class="n">hmm</span><span class="o">-</span><span class="n">threads</span> <span class="mi">4</span> \
        <span class="o">--</span><span class="n">emit</span><span class="o">-</span><span class="n">ref</span><span class="o">-</span><span class="n">confidence</span> <span class="n">GVCF</span> \
        <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">mode</span> <span class="n">EMIT_ALL_CONFIDENT_SITES</span>

<span class="n">gatk</span> <span class="n">GenomicsDBImport</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S2</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S3</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">genomicsdb</span><span class="o">-</span><span class="n">workspace</span><span class="o">-</span><span class="n">path</span> <span class="n">my_database</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">MT</span>

<span class="n">gatk</span> <span class="n">GenotypeGVCFs</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">gendb</span><span class="p">:</span><span class="o">//</span><span class="n">my_database</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">new</span><span class="o">-</span><span class="n">qual</span><span class="o">-</span><span class="n">calculator</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">joint_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">vcf</span>
</pre></div>
</div>
</div></blockquote>
<p>9.3 Llamado de variantes somáticas por individuo en modo tumor-control</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">Mutect2</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S2_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">tumor</span><span class="o">-</span><span class="n">sample</span> <span class="n">S2</span> \
        <span class="o">--</span><span class="nb">input</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
        <span class="o">--</span><span class="n">normal</span><span class="o">-</span><span class="n">sample</span> <span class="n">S1</span> \
        <span class="o">--</span><span class="n">germline</span><span class="o">-</span><span class="n">resource</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">af</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="n">gnomad</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">panel</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">normals</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="mi">1000</span><span class="n">g_pon</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">ClearSeq_Comprehensive_Cancer_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S2_S1</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div></blockquote>
<p>9.4 Llamado de variantes somáticas por individuo en modo tumor-only</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">Mutect2</span> \
<span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
<span class="o">--</span><span class="nb">input</span> <span class="n">S2_recal</span><span class="o">-</span><span class="n">reads</span><span class="o">.</span><span class="n">bam</span> \
<span class="o">--</span><span class="n">tumor</span><span class="o">-</span><span class="n">sample</span> <span class="n">S2</span> \
<span class="o">--</span><span class="n">germline</span><span class="o">-</span><span class="n">resource</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">af</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="n">gnomad</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
<span class="o">--</span><span class="n">panel</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">normals</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="mi">1000</span><span class="n">g_pon</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
<span class="o">--</span><span class="n">intervals</span> <span class="n">ClearSeq_Comprehensive_Cancer_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
<span class="o">--</span><span class="n">output</span> <span class="n">S2</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</li>
<li><p>Recalibración de SNVs</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">VariantRecalibrator</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">resource</span><span class="p">:</span><span class="n">hapmap</span><span class="p">,</span><span class="n">known</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">training</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">truth</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">prior</span><span class="o">=</span><span class="mf">15.0</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">hapmap_3</span><span class="o">.</span><span class="mf">3.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">resource</span><span class="p">:</span><span class="n">omni</span><span class="p">,</span><span class="n">known</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">training</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">truth</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">prior</span><span class="o">=</span><span class="mf">12.0</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="mi">1000</span><span class="n">G_omni2</span><span class="o">.</span><span class="mf">5.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">resource</span><span class="p">:</span><span class="mi">1000</span><span class="n">G</span><span class="p">,</span><span class="n">known</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">training</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">truth</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">prior</span><span class="o">=</span><span class="mf">10.0</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="mi">1000</span><span class="n">G_phase1</span><span class="o">.</span><span class="n">snps</span><span class="o">.</span><span class="n">high_confidence</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">resource</span><span class="p">:</span><span class="n">dbsnp</span><span class="p">,</span><span class="n">known</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">training</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">truth</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">prior</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">dbsnp_146</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">QD</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">FS</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">SOR</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">MQ</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">MQRankSum</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">ReadPosRankSum</span> \
        <span class="o">--</span><span class="n">mode</span> <span class="n">SNP</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">100.0</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">99.9</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">99.0</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">90.0</span> \
        <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">gaussians</span> <span class="mi">1</span> \
        <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">negative</span><span class="o">-</span><span class="n">gaussians</span> <span class="mi">1</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">SNP</span><span class="o">.</span><span class="n">recal</span> \
        <span class="o">--</span><span class="n">tranches</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">SNP</span><span class="o">.</span><span class="n">tranches</span> \
        <span class="o">--</span><span class="n">rscript</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">SNP</span><span class="o">-</span><span class="n">plots</span><span class="o">.</span><span class="n">R</span>
<span class="n">gatk</span> <span class="n">ApplyVQSR</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_raw</span><span class="o">-</span><span class="nb">vars</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">mode</span> <span class="n">SNP</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="nb">filter</span><span class="o">-</span><span class="n">level</span> <span class="mf">99.0</span> \
        <span class="o">--</span><span class="n">recal</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">SNP</span><span class="o">.</span><span class="n">recal</span> \
        <span class="o">--</span><span class="n">tranches</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">SNP</span><span class="o">.</span><span class="n">tranches</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">snps_raw</span><span class="o">-</span><span class="n">indels</span><span class="o">.</span><span class="n">vcf</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Recalibración de InDels</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">VariantRecalibrator</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">snps_raw</span><span class="o">-</span><span class="n">indels</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">resource</span><span class="p">:</span><span class="n">mills</span><span class="p">,</span><span class="n">known</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">training</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">truth</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">prior</span><span class="o">=</span><span class="mf">12.0</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">GATK4</span><span class="o">/</span><span class="n">Mills_and_1000G_gold_standard</span><span class="o">.</span><span class="n">indels</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">QD</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">FS</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">SOR</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">MQRankSum</span> \
        <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">annotation</span> <span class="n">ReadPosRankSum</span> \
        <span class="o">--</span><span class="n">mode</span> <span class="n">INDEL</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">100.0</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">99.9</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">99.0</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="n">tranche</span> <span class="mf">90.0</span> \
        <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">gaussians</span> <span class="mi">1</span> \
        <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">negative</span><span class="o">-</span><span class="n">gaussians</span> <span class="mi">1</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">INDEL</span><span class="o">.</span><span class="n">recal</span> \
        <span class="o">--</span><span class="n">tranches</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">INDEL</span><span class="o">.</span><span class="n">tranches</span> \
        <span class="o">--</span><span class="n">rscript</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">INDEL</span><span class="o">-</span><span class="n">plots</span><span class="o">.</span><span class="n">R</span>
<span class="n">gatk</span> <span class="n">ApplyVQSR</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_recal</span><span class="o">-</span><span class="n">snps_raw</span><span class="o">-</span><span class="n">indels</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">mode</span> <span class="n">INDEL</span> \
        <span class="o">--</span><span class="n">truth</span><span class="o">-</span><span class="n">sensitivity</span><span class="o">-</span><span class="nb">filter</span><span class="o">-</span><span class="n">level</span> <span class="mf">99.0</span> \
        <span class="o">--</span><span class="n">recal</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">INDEL</span><span class="o">.</span><span class="n">recal</span> \
        <span class="o">--</span><span class="n">tranches</span><span class="o">-</span><span class="n">file</span> <span class="n">S1_recalibrate</span><span class="o">-</span><span class="n">INDEL</span><span class="o">.</span><span class="n">tranches</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_recalibrated_variants</span><span class="o">.</span><span class="n">vcf</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Anotación de variantes: ID</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">VariantAnnotator</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_recalibrated_variants</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">intervals</span> <span class="n">TruSight_One_xt_GRCh38</span><span class="o">.</span><span class="n">bed</span> \
        <span class="o">--</span><span class="n">dbsnp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">dbSNP</span><span class="o">/</span><span class="n">dbSNP</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_annotated_variants</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">annotation</span> <span class="n">Coverage</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Selección de variantes</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">SelectVariants</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_annotated_variants</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_annotated_qd_dp_filtered_variants</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">selectExpressions</span> <span class="s2">&quot;QD &gt; 5.0 &amp;&amp; DP &gt; 10.0&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Anotación funcional de variantes</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gatk</span> <span class="n">Funcotator</span> \
        <span class="o">--</span><span class="n">variant</span> <span class="n">S1_annotated_qd_dp_filtered_variants</span><span class="o">.</span><span class="n">vcf</span> \
        <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">sources</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">funcotator_dataSources</span> \
        <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="nb">format</span> <span class="n">VCF</span> \
        <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="n">Genome</span><span class="o">/</span><span class="n">Homo_sapiens_GRCh38</span><span class="o">.</span><span class="n">fasta</span> \
        <span class="o">--</span><span class="n">ref</span><span class="o">-</span><span class="n">version</span> <span class="n">hg38</span> \
        <span class="o">--</span><span class="n">output</span> <span class="n">S1_func_annotated_qd_dp_filtered_variants</span><span class="o">.</span><span class="n">vcf</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Para descargar fuentes de anotación, es necesario entrar al servidor <a class="reference external" href="ftp://gsapubftp-anonymous&#64;ftp.broadinstitute.org/bundle/">ftp</a> del Broad Institute con nombre de usuario <code class="code docutils literal notranslate"><span class="pre">gsapubftp-anonymous</span></code> y contraseña <code class="code docutils literal notranslate"><span class="pre">gsapubftp-anonymous</span></code></p>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="formatos-formatos-everywhere">
<h2>Formatos… formatos everywhere<a class="headerlink" href="#formatos-formatos-everywhere" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="toggle admonition">
<p class="admonition-title">BAM</p>
<p>El formato BAM es similar en estructura al formato SAM, sin embargo, es el formato de elección para el manejo de alineamientos ya que está comprimido y ahorra mucho espacio</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">BED</p>
<p>El formato BED consta de archivos de texto plano con estructura tabular que indica posiciones dentro de un genoma</p>
<p>Este formato es indispensable para el manejo óptimo de alineamientos ya que nos permite filtrar unicamente por las regiones que nos interesan!</p>
<p>Hay distintas versiones del formato <a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">BED</a>, la estructura más básica consta de 4 a 6 columnas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">13</span>      <span class="mi">32316459</span>        <span class="mi">32316526</span>        <span class="n">BRCA2</span>   <span class="o">.</span>       <span class="o">+</span>
<span class="mi">13</span>      <span class="mi">32319075</span>        <span class="mi">32319324</span>        <span class="n">BRCA2</span>   <span class="o">.</span>       <span class="o">+</span>
<span class="mi">13</span>      <span class="mi">32325074</span>        <span class="mi">32325183</span>        <span class="n">BRCA2</span>   <span class="o">.</span>       <span class="o">+</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>El formato BED es 0-based para la segunda columna!</p>
<p>Si mi gen inicia en el nucleótido 345 y termina en el 678 del cromosoma MT, su nomenclatura en formato BED será la siguiente:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MT</span>      <span class="mi">344</span>     <span class="mi">678</span>     <span class="n">mi_gen</span>  <span class="o">.</span>       <span class="o">+</span>
</pre></div>
</div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">VCF</p>
<p>El formato VCF también es un archivo de texto plano con una estructura tabular:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  g204</span>
<span class="mi">1</span>       <span class="mi">13417</span>   <span class="n">rs777038595</span>     <span class="n">C</span>       <span class="n">CGAGA</span>   <span class="mf">324.73</span>  <span class="n">PASS</span>    <span class="n">AC</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">AF</span><span class="o">=</span><span class="mf">0.500</span><span class="p">;</span><span class="n">AN</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">BaseQRankSum</span><span class="o">=</span><span class="mf">0.583</span><span class="p">;</span><span class="n">DB</span><span class="p">;</span><span class="n">DP</span><span class="o">=</span><span class="mi">26</span><span class="p">;</span><span class="n">ExcessHet</span><span class="o">=</span><span class="mf">3.0103</span><span class="p">;</span><span class="n">FS</span><span class="o">=</span><span class="mf">0.000</span><span class="p">;</span><span class="n">MLEAC</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">MLEAF</span><span class="o">=</span><span class="mf">0.500</span><span class="p">;</span><span class="n">MQ</span><span class="o">=</span><span class="mf">22.21</span><span class="p">;</span><span class="n">MQRankSum</span><span class="o">=-</span><span class="mf">0.032</span><span class="p">;</span><span class="n">QD</span><span class="o">=</span><span class="mf">12.49</span><span class="p">;</span><span class="n">ReadPosRankSum</span><span class="o">=-</span><span class="mf">2.185</span><span class="p">;</span><span class="n">SOR</span><span class="o">=</span><span class="mf">0.446</span><span class="p">;</span><span class="n">VQSLOD</span><span class="o">=</span><span class="mf">0.698</span><span class="p">;</span><span class="n">culprit</span><span class="o">=</span><span class="n">ReadPosRankSum</span> <span class="n">GT</span><span class="p">:</span><span class="n">AD</span><span class="p">:</span><span class="n">DP</span><span class="p">:</span><span class="n">GQ</span><span class="p">:</span><span class="n">PL</span>  <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">99</span><span class="p">:</span><span class="mi">362</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">634</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Descripción extendida del formato vcf</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 11%" />
<col style="width: 85%" />
</colgroup>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1: CHROM</p></td>
<td rowspan="2"><p>1</p></td>
<td rowspan="2"><p>Cromosoma en dónde se ubica la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2: POS</p></td>
<td rowspan="2"><p>1053827</p></td>
<td rowspan="2"><p>Posición de la variante en el cromosoma</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>3: ID</p></td>
<td rowspan="2"><p>rs74685771</p></td>
<td rowspan="2"><p>Identificador de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>4: REF</p></td>
<td rowspan="2"><p>G</p></td>
<td rowspan="2"><p>Alelo de referencia</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>5: ALT</p></td>
<td rowspan="2"><p>C</p></td>
<td rowspan="2"><p>Alelo encontrado en la muestra</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>6: QUAL</p></td>
<td rowspan="2"><p>856.77</p></td>
<td rowspan="2"><p>Score de calidad de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>7: FILTER</p></td>
<td rowspan="2"><p>PASS</p></td>
<td rowspan="2"><p>Flag de calidad de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="34"><p>8:INFO</p></td>
<td rowspan="2"><p>AC=1;</p></td>
<td rowspan="2"><p>Número de alelos alternos encontrados</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AF=0.500;</p></td>
<td rowspan="2"><p>Frecuencia alelica (alelo alterno)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AN=2;</p></td>
<td rowspan="2"><p>Número total de alelos para una variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>BaseQRankSum=-2.129</p></td>
<td rowspan="2"><p>Z-score de la calidad de las bases mapeadas en el alelo alterno vs el alelo de referencia empleando una prueba de Wilcoxon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ClippingRankSum=-0.286;</p></td>
<td rowspan="2"><p>Z-score del número de lecturas con calidad de mapeo bajas para el alelo alterno vs el alelo de referencia empleando una prueba de Wilcoxon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DB;</p></td>
<td rowspan="2"><p>Indica si la variante pertenece a una base de datos (dbSNP)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DP=63;</p></td>
<td rowspan="2"><p>número de lecturas mapeadas en la posición de la variante</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>FS=0;</p></td>
<td rowspan="2"><p>P-value ajustado para determinar sesgo hacía una cadena de DNA empleando una prueba exacta de Fisher</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MLEAC=1;</p></td>
<td rowspan="2"><p>Máxima verosimilitud esperada para el número de alelos observados (depende del número de muestras).</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MLEAF=0.500;</p></td>
<td rowspan="2"><p>Máxima verosimilitud esperada para las frecuencias alélicas (depende del número de muestras).</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MQ=60.00;</p></td>
<td rowspan="2"><p>Calidad media de mapeo en la posición de la variante.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>MQRankSum=-0.0.635;</p></td>
<td rowspan="2"><p>Z-score de la calidad de mapeo las bases alíneadas en el alelo alterno vs el alelo de referencia empleando una prueba de Wilcoxon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>QD=13.60;</p></td>
<td rowspan="2"><p>Confianza del alelo observado (Quality over depth)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ReadPosRankSum=0.621;</p></td>
<td rowspan="2"><p>Z-score del sesgo posicional (con respecto de la longitud de la lectura) del alelo alternativo vs el alelo de referencia (depende del número de muestras)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>SOR=0.768;</p></td>
<td rowspan="2"><p>Suma simétrica de la razón de momios del número de lecturas que presentan la variante cerca del final de la lectura, vs las lecturas que la presentan cerca del inicio de la lectura.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>VQSLOD=3.39;</p></td>
<td rowspan="2"><p>Logaritmo de la razón de momios de que la variante sea verdadera vs que sea un falso positivo.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>culprit=qd</p></td>
<td rowspan="2"><p>El descriptor que presentó la métrica más desfavorable</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="10"><p>9:FORMAT</p></td>
<td rowspan="2"><p>GT</p></td>
<td rowspan="2"><p>Genotipo</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>AD</p></td>
<td rowspan="2"><p>Profundidad de los alelos observados (Ref,Alt)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>DP</p></td>
<td rowspan="2"><p>Profundidad total (número de lecturas</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>GQ</p></td>
<td rowspan="2"><p>Calidad del genotipado</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>PL</p></td>
<td rowspan="2"><p>Verosimilitud de genotipos (Obs,Nul,Alt)</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="10"><p>10:g204</p></td>
<td rowspan="2"><p>0/1</p></td>
<td rowspan="2"><p>Heterocigoto</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>37,26</p></td>
<td rowspan="2"><p>(G)37 reads + (C)26 reads</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>63</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>99</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>885,0,1386</p></td>
<td rowspan="2"></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>El formato VCF es 1-based en la segunda columna, por lo que es importante considerar esto cuando manejemos combinaciones de formatos (como con bedtools y bcftools)</p>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">GFF</p>
<p>El formato GFF consta de archivos de texto plano con estructura tabular que indica posiciones dentro de un genoma, pueden ser genes, mRNAs, exones, regiones codificantes, y un largo etcetera.</p>
<p>Este formato es uno de los estándares de anotación genómica y se emplea en todos los proyectos de genómica como referencia para obtener genes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">11869</span>   <span class="mi">12227</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000456328</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00002234944</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00002234944</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">lnc_RNA</span> <span class="mi">11869</span>   <span class="mi">14409</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">ID</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000456328</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">gene</span><span class="p">:</span><span class="n">ENSG00000223972</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">DDX11L1</span><span class="o">-</span><span class="mi">202</span><span class="p">;</span><span class="n">biotype</span><span class="o">=</span><span class="n">processed_transcript</span><span class="p">;</span><span class="n">tag</span><span class="o">=</span><span class="n">basic</span><span class="p">;</span><span class="n">transcript_id</span><span class="o">=</span><span class="n">ENST00000456328</span><span class="p">;</span><span class="n">transcript_support_level</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">pseudogene</span>      <span class="mi">11869</span>   <span class="mi">14409</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">ID</span><span class="o">=</span><span class="n">gene</span><span class="p">:</span><span class="n">ENSG00000223972</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">DDX11L1</span><span class="p">;</span><span class="n">biotype</span><span class="o">=</span><span class="n">transcribed_unprocessed_pseudogene</span><span class="p">;</span><span class="n">description</span><span class="o">=</span><span class="n">DEAD</span><span class="o">/</span><span class="n">H</span><span class="o">-</span><span class="n">box</span> <span class="n">helicase</span> <span class="mi">11</span> <span class="n">like</span> <span class="mi">1</span> <span class="p">[</span><span class="n">Source</span><span class="p">:</span><span class="n">HGNC</span> <span class="n">Symbol</span><span class="o">%</span><span class="mi">3</span><span class="n">BAcc</span><span class="p">:</span><span class="n">HGNC</span><span class="p">:</span><span class="mi">37102</span><span class="p">];</span><span class="n">gene_id</span><span class="o">=</span><span class="n">ENSG00000223972</span><span class="p">;</span><span class="n">logic_name</span><span class="o">=</span><span class="n">havana_homo_sapiens</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">5</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">12010</span>   <span class="mi">12057</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00001948541</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00001948541</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">pseudogenic_transcript</span>  <span class="mi">12010</span>   <span class="mi">13670</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">ID</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">gene</span><span class="p">:</span><span class="n">ENSG00000223972</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">DDX11L1</span><span class="o">-</span><span class="mi">201</span><span class="p">;</span><span class="n">biotype</span><span class="o">=</span><span class="n">transcribed_unprocessed_pseudogene</span><span class="p">;</span><span class="n">tag</span><span class="o">=</span><span class="n">basic</span><span class="p">;</span><span class="n">transcript_id</span><span class="o">=</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">transcript_support_level</span><span class="o">=</span><span class="n">NA</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">12179</span>   <span class="mi">12227</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00001671638</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00001671638</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">12613</span>   <span class="mi">12697</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00001758273</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00001758273</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">12613</span>   <span class="mi">12721</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000456328</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00003582793</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00003582793</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">12975</span>   <span class="mi">13052</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00001799933</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00001799933</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
<span class="mi">1</span>       <span class="n">havana</span>  <span class="n">exon</span>    <span class="mi">13221</span>   <span class="mi">13374</span>   <span class="o">.</span>       <span class="o">+</span>       <span class="o">.</span>       <span class="n">Parent</span><span class="o">=</span><span class="n">transcript</span><span class="p">:</span><span class="n">ENST00000450305</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">ENSE00001746346</span><span class="p">;</span><span class="n">constitutive</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ensembl_end_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">ensembl_phase</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">exon_id</span><span class="o">=</span><span class="n">ENSE00001746346</span><span class="p">;</span><span class="n">rank</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>La estructura del formato GFF consta de 9 columnas:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Campo</p></th>
<th class="head" rowspan="2"><p>Ejemplo</p></th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1: CHROM</p></td>
<td rowspan="2"><p>1</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>2: SOURCE</p></td>
<td rowspan="2"><p>havana</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>3: FEATURE</p></td>
<td rowspan="2"><p>exon</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>4: START</p></td>
<td rowspan="2"><p>13221</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>5: END</p></td>
<td rowspan="2"><p>13374</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>6: SCORE</p></td>
<td rowspan="2"><p>.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>7: STRAND</p></td>
<td rowspan="2"><p>+</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>8:FRAME</p></td>
<td rowspan="2"><p>.</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="16"><p>9:ATTRIBUTE</p></td>
<td rowspan="2"><p>Parent=transcript:ENST00000450305;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>Name=ENSE00001746346;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>constitutive=0;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ensembl_end_phase=-1;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>ensembl_phase=-1;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>exon_id=ENSE00001746346;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>rank=5;</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>version=2</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>El formato GFF es 1-based para la quinta columna!</p>
</div>
</div>
</div>
<div class="section" id="contacto">
<h2>Contacto<a class="headerlink" href="#contacto" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><dl class="simple">
<dt>Este curso es llevado a ti por <a class="reference external" href="https://atgenomics.com">ATGenomics</a>, una iniciativa dedicada a la divulgación, promoción y capacitación en bioinformática</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://twitter.com/Miss_dianolasa">&#64;dianolasa</a></p></li>
<li><p><a class="reference external" href="https://twitter.com/zorbax">&#64;zorbax</a></p></li>
<li><p><a class="reference external" href="https://twitter.com/vflorelo">&#64;vflorelo</a></p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, @atgenomics, @vflorelo, @dianolasa, @zorbax

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .admonition-title").show();
        $(".toggle .admonition-title").click(function() {
            $(this).parent().children().not(".admonition-title").toggle(400);
            $(this).parent().children(".admonition-title").toggleClass("open");
        })
    });
</script>


</body>
</html>